var dx_Documento_Codigo=function(){return{dataField:"codigo",caption:App.lang.documento.codigo,width:80}},dx_Documento_Nome=function(){return{dataField:"nome",caption:App.lang.documento.nome,width:200}},dx_Documento_Pasta_Path=function(){return{dataField:"path",caption:App.lang.documento.pasta,width:200}},dx_Documento_Aprovador_Nome=function(){return{dataField:"nome_usuario",caption:App.lang.documento.aprovador_nome,width:200,groupIndex:0}},dx_Documento_Recebimento_Data=function(){return{dataField:"recebimento_data",caption:App.lang.documento.recebimento_data,width:110,dataType:"date",format:"dd/MM/yyyy HH:mm"}},dx_Documento_Data_Aprovacao_Alcada=function(){return{dataField:"data_aprovacao_alcada",caption:App.lang.documento.data_aprovacao_alcada,width:110,dataType:"date",format:"dd/MM/yyyy HH:mm"}},dx_Documento_Prazo=function(){return{dataField:"prazo_data",caption:App.lang.documento.prazo,dataType:"date",format:"dd/MM/yyyy HH:mm",width:110,cellTemplate:function(o,a){if("1"===a.data.aprovacao_atrasada)o.text(a.text),o.addClass("text-danger"),o.attr("title","Atrasado");else o.text(a.text)}}},dx_Documento_Tag=function(){return{dataField:"tag",caption:App.lang.documento.tag,width:100}},dx_Documento_Assunto=function(){return{dataField:"assunto_descricao",caption:App.lang.documento.assunto,width:100}},dx_Documento_Tipo=function(){return{dataField:"tipo_documento_nome",caption:App.lang.documento.tipo,width:100}},dx_Documento_Revisao=function(){return{dataField:"revisao_sequencia",caption:App.lang.documento.revisao,width:80}},dx_Documento_Tipo_Pendencia=function(){return{dataField:"tipo_pendencia",caption:App.lang.documento.tipo_pendencia,width:80,lookup:{dataSource:[{id:"A",descricao:"Aprovação"},{id:"D",descricao:"Distribuição"}],displayExpr:"descricao",valueExpr:"id"}}},dx_Documento_Pendencia_Situacao=function(){return{dataField:"situacao",caption:App.lang.documento.situacao,width:200,lookup:{dataSource:[{id:"A1",descricao:"Pendente de Aprovação"},{id:"A2",descricao:"Aprovado"},{id:"A3",descricao:"Reprovado"},{id:"A4",descricao:"Aprovado por terceiro"},{id:"A5",descricao:"Reprovado por terceiro"},{id:"A6",descricao:"Aguardando Alçada"},{id:"D1",descricao:"Adicionar documento em um local"},{id:"D2",descricao:"Remover documento de um local"},{id:"D3",descricao:"Documento pendente de leitura"}],displayExpr:"descricao",valueExpr:"id"},cellTemplate:function(o,a){switch(a.data.situacao){case"A"+GED_APROVACAO_SITUACAO.APROVADO:case"A"+GED_APROVACAO_SITUACAO.APROVADO_POR_TERCEIRO:o.text("Aprovado Nível "+a.data.nivel+" em "+a.data.data_aprovacao_alcada.format_date_time());break;case"A"+GED_APROVACAO_SITUACAO.REPROVADO:case"A"+GED_APROVACAO_SITUACAO.REPROVADO_POR_TERCEIRO:o.text("Reprovado Nível "+a.data.nivel+" em "+a.data.data_aprovacao_alcada.format_date_time());break;case"D"+DISTRIBUICAO_CONTROLADA_TIPO_ACAO.CIENCIA:o.text("Documento pendente de leitura");break;case"D"+DISTRIBUICAO_CONTROLADA_TIPO_ACAO.ADICIONAR:o.text("Adicionar documento "+(a.data.local_distribuicao?" localizado em: "+a.data.local_distribuicao:""));break;case"D"+DISTRIBUICAO_CONTROLADA_TIPO_ACAO.REMOVER:o.text("Remover documento "+(a.data.local_distribuicao?" localizado em: "+a.data.local_distribuicao:""));break;default:o.text(a.displayValue)}}}},dx_Documento_Pendencia_Situacao_Prazo=function(){return{dataField:"aprovacao_atrasada",caption:App.lang.documento.situacao_prazo,width:100,lookup:{dataSource:[{id:"1",descricao:"Atrasado"},{id:"0",descricao:"Dentro do prazo"}],displayExpr:"descricao",valueExpr:"id"}}},dx_Documento_Tamanho=function(){return{dataField:"revisao_tamanho",caption:App.lang.documento.tamanho,width:80,allowFiltering:!1,cellTemplate:function(o,a){var e=a.data.revisao_tamanho||0;o.text(filesize(parseInt(e,10)||0))}}},dx_Documento_Modificacao=function(){return{dataField:"revisao_data_envio",caption:App.lang.documento.modificacao,width:110,dataType:"date",format:"dd/MM/yyyy HH:mm"}},dx_Documento_Vigente_Ate=function(){return{dataField:"vigente_ate",caption:App.lang.documento.vigente_ate,width:110,dataType:"date",format:"dd/MM/yyyy HH:mm"}},dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Request=function(o,a,e,t,n){var i={documento_id:a.documento_id,documento_revisao_id:a.documento_revisao_id,aprovacao:e,documento_aprovacao_alcada_id:a.documento_aprovacao_alcada_id};null!=o&&(i.rejeitar=o),null!=t&&(i.consideracoes=t),WS.post("documento/salvar_documento_aprovacao_revisoes/",i,function(o){o&&n.dataGridPendencias.refresh()})},dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Documento=function(o,a,e,t){void 0!==o.documento_id&&0!==parseInt(o.documento_id,10)&&WS.get({route:"documento/qtde_revisoes_pendentes/",data:{documento_id:o.documento_id},func_response:function(n){if(parseInt(n.qtde)>0){alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Aviso!',"<div><p>Deseja rejeitar as revisões anteriores do documento ?</p></div>","Sim",function(){dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Request(!0,o,a,e,t)},!0,"Não",null,function(){dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Request(!1,o,a,e,t)})}else dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Request(!1,o,a,e,t)}})},dx_Documento_Pendencias_Distribuicao_Upload_Arquivo=null,dx_Documento_Pendencias_Botoes=function(o){var a=get_icon_class();return{type:"buttons",buttons:[{hint:App.lang.generico.download,icon:"glyphicon glyphicon-download",cssClass:a,visible:function(o){return!!o.row.data.documento_revisao_id},onClick:function(o){o.row.data.documento_revisao_id?App.obter_token_publico(function(a){App.download(WS_URI+"documento/download/?documento_revisao_id="+o.row.data.documento_revisao_id+"&token_publico="+a)}):alert_modal("Download","Nenhuma versão do documento disponível para download")}},{hint:App.lang.generico.visualizar,icon:"fa fa-window-maximize",cssClass:a,visible:function(o){return!!o.row.data.documento_revisao_id},onClick:function(o){"application/pdf"==o.row.data.mime_type?View.load("central_documentos/visualizar_pdf",function(a,e){e.show(o.row.data.documento_revisao_id)}):"image/png"==o.row.data.mime_type||"image/bmp"==o.row.data.mime_type||"image/jpeg"==o.row.data.mime_type||"image/jpg"==o.row.data.mime_type||"image/gif"==o.row.data.mime_type?View.load("central_documentos/visualizar_documento",function(a,e){e.show(o.row.data.documento_revisao_id)}):View.load("central_documentos/documento",function(a,e){e.show(o.row.data.documento_id,FORMULARIO.EDITAR,o.row.data.documento_pasta_id,!1,null,null,null,null,null)},View.ABA.MULTIPLAS)}},{hint:App.lang.documento.observacoes,icon:"glyphicon glyphicon-comment",cssClass:a,onClick:function(o){View.load("central_documentos/documento",function(a,e){e.show(o.row.data.documento_id,FORMULARIO.EDITAR,o.row.data.documento_pasta_id,!1,null,null,null,null,null,!0)},View.ABA.MULTIPLAS)}},{hint:App.lang.documento.substituir_arquivo,icon:"fa fa-cloud-upload-alt",cssClass:a,visible:function(o){return o.row.data.situacao=="A"+GED_APROVACAO_SITUACAO.AGUARDANDO&&App.verifica_permissao(App.temp.empresa,"substituir_revisao")},onClick:function(a){var e=function(){o.dataGridPendencias.refresh()};View.load("central_documentos/substituir_revisao",function(o,t){t.onsave=e,t.show(a.row.data.documento_aprovacao_alcada_id,a.row.data.codigo,a.row.data.nome,a.row.data.revisao_sequencia,a.row.data.revisao_nome,a.row.data.revisao_tamanho)})}},{hint:App.lang.generico.aprovar,icon:"glyphicon glyphicon-ok",cssClass:a,visible:function(o){return o.row.data.situacao=="A"+GED_APROVACAO_SITUACAO.AGUARDANDO},onClick:function(a){alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Aviso!',"Deseja realmente aprovar o Documento: "+a.row.data.nome+' ?<div class="form-group"><br /><textarea class="form-control" rows="5" id="consideracoes" style="min-width: 100%; max-width: 100%" placeholder="Considerações sobre o documento."></textarea></div>',"Sim",function(){var e=document.getElementById("consideracoes").value;dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Documento(a.row.data,"S",e,o)},!0,"Não",null,function(){return!1})}},{hint:App.lang.generico.reprovar,icon:"glyphicon glyphicon-remove",cssClass:a,visible:function(o){return o.row.data.situacao=="A"+GED_APROVACAO_SITUACAO.AGUARDANDO},onClick:function(a){alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Aviso!',"Por gentileza, informe o motivo pelo qual deseja reprovar o Documento: <br />"+a.row.data.nome+'<div class="form-group"><br /><textarea class="form-control" rows="5" id="consideracoes" style="min-width: 100%; max-width: 100%" placeholder="digite o motivo da reprova do documento."></textarea></div>',"Reprovar",function(){var e=document.getElementById("consideracoes").value;dx_Documento_Pendencias_Botoes_Aprovar_Reprova_Documento(a.row.data,"N",e,o)},!0,"Cancelar",null,function(){return!1})}},{hint:App.lang.generico.marcar_realizado,icon:"glyphicon glyphicon-ok",cssClass:a,visible:function(o){return"D"==o.row.data.tipo_pendencia},onClick:function(a){alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-info" style="text-align: center"> <span href="#" class="alert-link"><strong>Esta ação irá marcar essa atividade como </strong>concluído,<strong> deseja continuar ?</strong></span></div><div id="file-uploader"></div>','<i class="fa fa-check" aria-hidden="true"></i> Confirmar',function(){WS.post("documento_distribuicao_controlada/marcar_realizado/",{id:a.row.data.documento_distribuicao_controlada_id,documento_id:a.row.data.documento_id,documento_revisao_id:a.row.data.documento_revisao_id,documento_confirmacao_distribuicao:dx_Documento_Pendencias_Distribuicao_Upload_Arquivo.props.arquivoSelecionado},function(a){var e=!0===a?"success":"error",t=!0===a?"Atividade concluída com sucesso":"Falha ao concluir a atividade";DevExpress.ui.notify.default({message:t,type:e,displayTime:3e3,width:300}),!0===a&&o.dataGridPendencias.refresh()},null,null,!0)},!0),require(["react","react-dom","assets/view/componentes_react/InputArquivo"],function(o,a,e){dx_Documento_Pendencias_Distribuicao_Upload_Arquivo=o.createElement(e,null,null),a.render(dx_Documento_Pendencias_Distribuicao_Upload_Arquivo,$("#file-uploader")[0]),dx_Documento_Pendencias_Distribuicao_Upload_Arquivo.props.setDesabilitado(!1)})}}]}},dx_Documentos_Pendencias_Colunas=function(o){return[dx_Documento_Aprovador_Nome(),dx_Documento_Codigo(),dx_Documento_Nome(),dx_Documento_Recebimento_Data(),dx_Documento_Prazo(),dx_Documento_Data_Aprovacao_Alcada(),dx_Documento_Pendencia_Situacao_Prazo(),dx_Documento_Tag(),dx_Documento_Assunto(),dx_Documento_Tipo(),dx_Documento_Revisao(),dx_Documento_Tipo_Pendencia(),dx_Documento_Pendencia_Situacao(),dx_Documento_Tamanho(),dx_Documento_Modificacao(),dx_Documento_Vigente_Ate(),dx_Documento_Pasta_Path(),dx_Documento_Pendencias_Botoes(o)]};