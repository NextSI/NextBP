define([],function(){return function(i){"use strict";var o=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Supervisores",this.tab_listagem=this.dialog.find(".tab_listagem"),this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.btn_filtrar=this.dialog.find(".btn_filtrar"),this.nome_usuario=null,this.email=null,this.tipo_usuario=[USUARIO_TIPO.COLABORADOR],this.admin=!0,this.grupo_usuarios=!0,this.bloqueado=!1,this.listar=function(){var i=o.tab_listagem.find("tbody"),t=i.find("tr:first");o.tab_listagem.find("tr:gt(1)").remove(),WS.get("supervisor/listar/",{nome:o.nome_usuario,email:o.email,tipo_usuario:o.tipo_usuario,admin:o.admin,bloqueado:o.bloqueado,grupo_usuarios:o.grupo_usuarios},function(s){$(s).each(function(s,a){!function(s){var a=t.clone();a.removeAttr("template-row"),a.css("display","");var u=$('<span class="label lb_tipo" style="margin: 5px;"></span>');s.nome_usuario?(u.addClass("tipo_executor label-info"),u.attr("title","Usu치rio"),u.attr("data-original-title","Usu치rio"),u.text("U"),u.attr("tipo","usuario")):s.nome_grupo_usuarios&&(u.addClass("tipo_executor label-warning"),u.attr("title","Grupo de Usu치rios"),u.attr("data-original-title","Grupo de Usu치rios"),u.text("GU"),u.attr("tipo","grupo_usuarios")),u.tooltip();var n=$(a.find("[template-field='nome']"));n.html(u),n.append(s.nome_usuario?s.nome_usuario:s.nome_grupo_usuarios?s.nome_grupo_usuarios:""),$(a.find("[template-field='email']")).text(s.email?s.email:""),$(a.find("[template-field='bloqueado']")).html(str_yes_no(s.bloqueado)),$(a.find("[template-field='admin']")).html(str_yes_no(s.admin));var r=$(a.find(".btn_visualizar"));r.unbind("click"),r.click(function(){View.load("supervisor/detalhes",function(i,o){o.show(s.usuario_id,s.nome_usuario,s.grupo_usuarios_id,s.nome_grupo_usuarios,FORMULARIO.VISUALIZAR)},View.ABA.MULTIPLAS)});var e=$(a.find(".btn_editar")),l=function(){View.load("supervisor/detalhes",function(i,t){t.onclose=o.listar,t.show(s.usuario_id,s.nome_usuario,s.grupo_usuarios_id,s.nome_grupo_usuarios,FORMULARIO.EDITAR)},View.ABA.MULTIPLAS)};e.unbind("click"),e.click(l),a.dblclick(l);var d=$(a.find(".btn_excluir"));d.unbind("click"),d.click(function(){View.load("supervisor/detalhes",function(i,t){t.onclose=o.listar,t.show(s.usuario_id,s.nome_usuario,s.grupo_usuarios_id,s.nome_grupo_usuarios,FORMULARIO.EXCLUIR)},View.ABA.MULTIPLAS)}),a.appendTo(i)}(a)})})},this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("supervisor/detalhes",function(i,t){t.onclose=o.listar,t.show(null,"",null,"",FORMULARIO.NOVO)},View.ABA.MULTIPLAS)}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){o.listar()}),this.btn_filtrar.unbind("click"),this.btn_filtrar.click(function(){View.load("supervisor/parametros",function(i,t){t.onclose=o.listar,t.show(function(i){o.nome_usuario=i.nome_usuario,o.email=i.email,o.tipo_usuario=i.tipo_usuario,o.admin=i.admin,o.bloqueado=i.bloqueado,o.grupo_usuarios=i.grupo_usuarios},o.nome_usuario,o.email,o.tipo_usuario,o.admin,o.bloqueado,o.grupo_usuarios)})}),this.unload=function(){View.unload(this.html_id)},this.listar()}});