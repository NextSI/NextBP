define(["react","react-dom","./../componentes_react/CboClientes","./../atividade_projeto/ListarAtividadeProjeto"],function(a,e,i,o){return function(n){"use strict";var t=this;this.html_id=n,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.onsave=null,this.label_modal_evento_agenda_novo=this.dialog.find(".label_modal_evento_agenda_novo"),this.edt_evento_dia=this.dialog.find(".edt_evento_dia"),this.edt_evento_inicio=this.dialog.find(".edt_evento_inicio"),this.edt_evento_inicio_instance=null,this.edt_evento_fim=this.dialog.find(".edt_evento_fim"),this.edt_evento_fim_instance=null,this.edt_evento_notificar_antes=this.dialog.find(".edt_evento_notificar_antes"),this.chk_dia_inteiro=this.dialog.find(".chk_dia_inteiro"),this.div_evento_inicio=this.dialog.find(".div_evento_inicio"),this.div_evento_fim=this.dialog.find(".div_evento_fim"),this.div_evento_notificar_antes=this.dialog.find(".div_evento_notificar_antes"),this.edt_titulo=this.dialog.find(".edt_titulo"),this.edt_evento_descricao=this.dialog.find(".edt_evento_descricao"),this.edt_percentual_atuacao=this.dialog.find(".edt_percentual_atuacao"),this.edt_percentual_competencia=this.dialog.find(".edt_percentual_competencia"),this.edt_valor_atuacao=this.dialog.find(".edt_valor_atuacao"),this.edt_valor_competencia=this.dialog.find(".edt_valor_competencia"),this.tipo_agenda=this.dialog.find(".tipo_agenda"),this.cbo_evento_tipo_agenda=this.dialog.find(".cbo_evento_tipo_agenda"),this.cbo_evento_local=this.dialog.find(".cbo_evento_local"),this.dx_selecao_ativos=this.dialog.find(".dx_selecao_ativos"),this.cbo_evento_cliente=this.dialog.find(".cbo_evento_cliente"),this.cbo_evento_fornecedor=this.dialog.find(".cbo_evento_fornecedor"),this.cbo_evento_prospect=this.dialog.find(".cbo_evento_prospect"),this.cbo_evento_empresa=this.dialog.find(".cbo_evento_empresa"),this.cbo_evento_projeto=this.dialog.find(".cbo_evento_projeto"),this.div_componente_convidado=this.dialog.find(".div_componente_convidado"),this.modal_evento=this.dialog.find(".modal_evento"),this.div_projeto=this.dialog.find(".div_projeto"),this.div_atividade_projeto=this.dialog.find(".div_atividade_projeto"),this.div_componente_atividades=this.dialog.find(".div_componente_atividades"),this.tab_historico=this.dialog.find(".tab_historico"),this.tb_convidados=this.dialog.find(".tb_convidados"),this.lbl_tab_historico=this.dialog.find(".lbl_tab_historico"),this.lbl_tab_recorrencia=this.dialog.find(".lbl_tab_recorrencia"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_confirmar=this.dialog.find(".btn_confirmar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.div_load=this.dialog.find(".div_load"),this.btn_ok=this.dialog.find(".btn_ok"),this.div_component_cbo_clientes=this.dialog.find(".div_component_cbo_clientes"),this.cboClientes=a.createElement(i,{initial_values:{placeholder:"Pesquisar por nome/cnpj"}},null),this.ListarAtividadeProjeto=a.createElement(o,null,null),this.div_radio_tipo_recorrencia=this.dialog.find(".div_radio_tipo_recorrencia"),this.div_diario=this.dialog.find(".div_diario"),this.div_semanal=this.dialog.find(".div_semanal"),this.div_mensal=this.dialog.find(".div_mensal"),this.div_anual=this.dialog.find(".div_anual"),this.edt_quantidade_diario=this.dialog.find(".edt_quantidade_diario"),this.edt_quantidade_semanal=this.dialog.find(".edt_quantidade_semanal"),this.chk_mensal_domingo=this.dialog.find(".chk_mensal_domingo"),this.chk_mensal_segunda=this.dialog.find(".chk_mensal_segunda"),this.chk_mensal_terca=this.dialog.find(".chk_mensal_terca"),this.chk_mensal_quarta=this.dialog.find(".chk_mensal_quarta"),this.chk_mensal_quinta=this.dialog.find(".chk_mensal_quinta"),this.chk_mensal_sexta=this.dialog.find(".chk_mensal_sexta"),this.chk_mensal_sabado=this.dialog.find(".chk_mensal_sabado"),this.edt_dia_mes=this.dialog.find(".edt_dia_mes"),this.edt_qtde_mes=this.dialog.find(".edt_qtde_mes"),this.cbo_numero_da_semana=this.dialog.find(".cbo_numero_da_semana"),this.cbo_dia_semana=this.dialog.find(".cbo_dia_semana"),this.edt_mensal_qtde=this.dialog.find(".edt_mensal_qtde"),this.edt_quantidade_ano=this.dialog.find(".edt_quantidade_ano"),this.cbo_anual_meses=this.dialog.find(".cbo_anual_meses"),this.edt_anual_dia=this.dialog.find(".edt_anual_dia"),this.cbo_anual_numero_da_semana=this.dialog.find(".cbo_anual_numero_da_semana"),this.cbo_anual_dia_semana=this.dialog.find(".cbo_anual_dia_semana"),this.cbo_anual_meses2=this.dialog.find(".cbo_anual_meses2"),this.edt_data_inicial=this.dialog.find(".edt_data_inicial"),this.edt_intervalo_recorrencia_quantidade_dias=this.dialog.find(".edt_intervalo_recorrencia_quantidade_dias"),this.div_intervalo_recorrencia=this.dialog.find(".div_intervalo_recorrencia"),this.div_intervalo_recorrencia_geral=this.dialog.find(".div_intervalo_recorrencia_geral"),this.edt_data_final=this.dialog.find(".edt_data_final"),this.div_local_agenda=this.dialog.find(".div_local_agenda"),this.div_dados_projeto=this.dialog.find(".div_dados_projeto"),this.cbo_evento_tipo=this.dialog.find(".cbo_evento_tipo"),this.opt_radio_diario=this.dialog.find('input[name="opt_radio_diario"]'),this.opt_tipo_intervalo_recorrencia=this.dialog.find('input[name="opt_tipo_intervalo_recorrencia"]'),this.opt_radio_mensal=this.dialog.find('input[name="opt_radio_mensal"]'),this.opt_radio_tipo_recorrencia=this.dialog.find('input[name="opt_radio_tipo_recorrencia"]'),this.opt_radio_anual=this.dialog.find('input[name="opt_radio_anual"]'),this.div_chk_semanal=this.dialog.find(".chk_semanal"),this.menu_geral=this.dialog.find(".menu_geral"),this.aba_geral=this.dialog.find(".aba_geral"),this.menu_recorrencia=this.dialog.find(".menu_recorrencia"),this.aba_recorrencia=this.dialog.find(".aba_recorrencia"),this.menu_historico=this.dialog.find(".menu_historico"),this.aba_historico=this.dialog.find(".aba_historico"),this.lbl_tab_referencias=this.dialog.find(".lbl_tab_referencias"),this.menu_referencias=this.dialog.find(".menu_referencias"),this.aba_referencias=this.dialog.find(".aba_referencias"),this.gridReferencias=this.dialog.find("#gridReferencias"),this.aba_convidados=this.dialog.find(".aba_convidados"),this.menu_convidados=this.dialog.find(".menu_convidados"),this.menu_responsavel=this.dialog.find(".menu_responsavel"),this.edt_horas_recorrencia=this.dialog.find(".edt_horas_recorrencia"),this.chk_utiliza_calendario_trabalho=this.dialog.find(".chk_utiliza_calendario_trabalho"),this.chk_realizado=this.dialog.find(".chk_realizado"),this.div_horas=this.dialog.find(".div_horas"),this.div_valor=this.dialog.find(".div_valor"),this.div_percentual=this.dialog.find(".div_percentual"),this.tbl_agenda_usuario=this.dialog.find(".tbl_agenda_usuario"),this.chk_notificar_envolvidos=this.dialog.find(".chk_notificar_envolvidos"),this.menu_emails_acompanhamento=this.dialog.find(".menu_emails_acompanhamento"),this.aba_emails_acompanhamento=this.dialog.find(".aba_emails_acompanhamento"),this.grid_emails_acompanhamento=this.dialog.find("#grid_emails_acompanhamento"),this.div_info_feriado=this.dialog.find(".div_info_feriado"),this.sel_evento_id=null,this.sel_usuario_id=null,this.evento_cliente_id=null,this.evento_cliente_nome=null,this.evento_fornecedor_id=null,this.evento_prospect_id=null,this.evento_empresa_id=null,this.evento_projeto_id=null,this.evento_tipo_agenda_id=null,this.projeto_atividade_id=null,this.limite=0,this.arr_agenda_recorrente=null,this.tipo_reprogramacao=null,this.arr_usuarios=[],this.envolvido_tipo=null,this.previsao_inicio=null,this.horas_previstas=null,this.somente_realizado=!1,this.agenda_ativo_id=null,this.sugestao_local_agenda=null,this.sugestao_tipo_agenda=null,this.usuario_nome,this.calendario_trabalho_id=null,this.criado_por=null,this.evento_id=null,this.dia_evento=null,this.convidado_evento=null,this.evento_pessoal=!1,this.forcar_evento_dia=!1,this.filtros=null,this.permite_desabilitar=!1,this.evento_possui_recorrencia=!1,this.permissao_manutencao_agenda_ativo="N",this.emails_acompanhamento=[],this.permissao_alterar=null,this.arr_feriados=[],this.arrAtivos=[],this.arrAtivosSelecionados=[],this.referencia_tabela=null,this.referencia_id=null,this.show=function(a,e,i,o,n,d,_,r,l,s){t.forcar_evento_dia=s,"object"==typeof a&&null!=a?(e=a.usuario_id,i=a.dia,t.dia_evento=i,o=a.usuario_nome,t.calendario_trabalho_id=+a.calendario_trabalho_id||0,n=a.obj_dados_projeto,t.agenda_ativo_id=-1==a.agenda_ativo_id?null:a.agenda_ativo_id,t.criado_por=a.criado_por||null,t.evento_id=a,t.convidado_evento=l||"S"==a.convidado_evento||1==a.convidado_evento,t.forcar_evento_dia=a.forcar_evento_dia,t.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo||"N",t.referencia_tabela=a.referencia_tabela||null,t.referencia_id=a.referencia_id||null,a=a.evento_id):(t.agenda_ativo_id=d,t.calendario_trabalho_id=+_||0,t.criado_por=r||0),t.usuario_nome=o,t.edt_horas_recorrencia.mask("000:00"),t.edt_valor_atuacao.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),t.edt_valor_competencia.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),t.aba_geral.attr("id","aba_geral"+t.html_id),t.menu_geral.attr("href","#"+t.aba_geral.attr("id")),t.aba_recorrencia.attr("id","aba_recorrencia"+t.html_id),t.menu_recorrencia.attr("href","#"+t.aba_recorrencia.attr("id")),t.aba_historico.attr("id","aba_historico"+t.html_id),t.menu_historico.attr("href","#"+t.aba_historico.attr("id")),t.aba_convidados.attr("id","aba_convidados"+t.html_id),t.menu_convidados.attr("href","#"+t.aba_convidados.attr("id")),t.menu_responsavel.attr("href","#"+t.aba_convidados.attr("id")),t.aba_emails_acompanhamento.attr("id","aba_emails_acompanhamento"+t.html_id),t.menu_emails_acompanhamento.attr("href","#"+t.aba_emails_acompanhamento.attr("id")),t.aba_referencias.attr("id","aba_referencias"+t.html_id),t.menu_referencias.attr("href","#"+t.aba_referencias.attr("id")),a||t.menu_referencias.addClass("hidden"),t.edt_evento_descricao.attr("id","edt_evento_descricao"+t.html_id),set_datepicker(t.edt_evento_dia),set_datepicker(t.edt_data_inicial),t.label_modal_evento_agenda_novo.hide(),t.edt_evento_inicio_instance=t.edt_evento_inicio.dxDateBox({type:"time",dateSerializationFormat:"HH:mm",showClearButton:!1,useMaskBehavior:!0,placeholder:"hh:mm",interval:15}).dxDateBox("instance"),t.edt_evento_fim_instance=t.edt_evento_fim.dxDateBox({type:"time",dateSerializationFormat:"HH:mm",showClearButton:!1,useMaskBehavior:!0,placeholder:"hh:mm",interval:15}).dxDateBox("instance"),t.limpar_evento(i),t.renderizarComponenteConvidado(),create_combobox(t.cbo_evento_projeto,t.listar_projeto);var c={manutencao_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),manutencao_propria_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),manutencao_agenda_ativo:App.verifica_permissao(App.temp.empresa,"manutencao_agenda_ativo")&&("S"==t.permissao_manutencao_agenda_ativo||"P"==t.permissao_manutencao_agenda_ativo&&!a)},p=App.sessao.dados.admin||!(+t.agenda_ativo_id>0)&&c.manutencao_agenda||!(+t.agenda_ativo_id>0)&&c.manutencao_propria_agenda&&+e>0&&+e==App.sessao.dados.usuario_id||+t.agenda_ativo_id>0&&c.manutencao_agenda_ativo;t.permissao_alterar=p,t.permite_alterar(p,t.convidado_evento),0==t.calendario_trabalho_id&&t.chk_utiliza_calendario_trabalho.parent().addClass("hidden"),a?(t.sel_evento_id=a,t.preencher()):(set_tinymce(t.edt_evento_descricao,"",t.permite_desabilitar),t.chk_utiliza_calendario_trabalho.removeClass("template_switch"),App.aplicar_checkbox(t.div_horas),void 0!==n&&null!=n&&(t.evento_cliente_id=n.cliente_id,t.evento_cliente_nome=n.cliente_nome,t.evento_projeto_id=n.projeto_id,t.evento_projeto_nome=n.projeto_nome,t.projeto_atividade_id=n.projeto_atividade_id,t.previsao_inicio=n.previsao_inicio,t.horas_previstas=n.horas_previstas,t.filtros.cliente_id=t.evento_cliente_id,t.filtros.cliente_nome=t.evento_cliente_nome,t.div_projeto.removeClass("hidden"),t.div_atividade_projeto.removeClass("hidden"),t.listar_atividades_projeto(t.evento_projeto_id),set_value_combobox(t.cbo_evento_projeto,t.evento_projeto_id,t.evento_projeto_nome)),t.title.html(" "+App.lang.gestao_agenda.novo_evento+' <span class="small">'+o+"</span>"),t.listar_tipo_agenda(),t.listar_local_agenda(),t.initSelecaoAtivos(),setTimeout(function(){null!=t.previsao_inicio&&""!=t.previsao_inicio?(set_datepicker(t.edt_evento_dia,t.previsao_inicio),set_datepicker(t.edt_data_inicial,t.previsao_inicio)):(set_datepicker(t.edt_evento_dia,"object"==typeof i?i.dia:i),set_datepicker(t.edt_data_inicial,"object"==typeof i?i.dia:i))},150),null!=t.horas_previstas&&""!=t.horas_previstas&&(t.edt_horas_recorrencia.val(t.horas_previstas),t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="3"]').prop("checked",!0)),t.sel_evento_id=a,t.sel_usuario_id=e,t.label_modal_evento_agenda_novo.show(),t.btn_excluir.hide(),t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').prop("checked",!0),t.div_intervalo_recorrencia_geral.addClass("hidden"),show_modal(t.modal.attr("id")),set_value_combobox(t.cbo_evento_tipo,App.temp.empresa,App.temp.nome_empresa,""),t.evento_empresa_id=App.temp.empresa,t.renderiza_componentes(),+t.agenda_ativo_id>0&&(t.menu_convidados.addClass("hidden"),t.menu_responsavel.removeClass("hidden"),WS.get({route:"agenda_ativo/objeto/",data:{agenda_ativo_id:t.agenda_ativo_id},func_response:function(a){t.sugestao_local_agenda=a.agenda_local_id,t.sugestao_tipo_agenda=a.agenda_motivo_id,t.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo,setTimeout(function(){t.cbo_evento_local.val(t.sugestao_local_agenda).selectpicker("refresh"),t.cbo_evento_tipo_agenda.val(t.sugestao_tipo_agenda).selectpicker("refresh")},400)}}))),t.preencher_emails_acompanhamento(),t.listar_feriados()},this.initSelecaoAtivos=()=>{if(t.agenda_ativo_id)return t.dx_selecao_ativos.closest(".row").hide(),!1;WS.get({route:"agenda_ativo/get_ativos_por_usuario/",func_response:t.renderSelecaoAtivos})},this.renderSelecaoAtivos=a=>{if(t.agenda_ativo_id)return!1;a&&(t.arrAtivos=a),ReactDOM.unmountComponentAtNode(t.dx_selecao_ativos[0]),ReactDOM.render(React.createElement(window.components.SelecaoAtivos.default,{label:null,placeholder:"Selecione ...",selecionado:t.arrAtivosSelecionados,items:t.arrAtivos,aoAlterar:a=>{t.validar_relacionados(null,a)},maxDisplayedTags:2,noDataText:"Não existem ativos"}),t.dx_selecao_ativos[0],()=>{})},this.renderizarComponenteConvidado=function(){var a={aoAlterar:t.select_convidado,limparAoAlterar:!0,dropDownContainer:t.div_componente_convidado[0],stateStoringNome:"agenda_evento_selecao_convidado",stateStoringColunas:["usuario_tipo"]};ReactDOM.render(React.createElement(window.components.SelecaoUsuario.default,a),t.div_componente_convidado[0])},this.select_convidado=function(a,e,i){if(a){var o={usuario_id:e.id,nome:e.nome,excluido:e.excluido,email:e.email};t.render_usuarios(o),i.columnOption("nome","filterValue",null),i.columnOption("email","filterValue",null),i.columnOption("nome","selectedFilterOperation",null),i.columnOption("email","selectedFilterOperation",null)}},this.preencher_emails_acompanhamento=function(){WS.get("agenda_evento/listar_emails_acompanhamento/",{agenda_evento_id:t.sel_evento_id},function(a){t.gridEmailsAcompanhamento(a)})},this.gridEmailsAcompanhamento=function(a){var e=get_icon_class();t.grid_emails_acompanhamento=t.grid_emails_acompanhamento.dxDataGrid({dataSource:a,showBorders:!0,paging:{enabled:!1},editing:{mode:"cell",allowUpdating:t.permissao_alterar,allowDeleting:t.permissao_alterar,allowAdding:t.permissao_alterar},columns:[{dataField:"email",caption:"E-mails adicionais para acompanhamento",dataType:"string",validationRules:[{type:"email"}],fixed:!0,fixedPosition:"left"},{type:"buttons",fixed:!0,fixedPosition:"right",buttons:[{hint:"Remover e-mail",icon:"fa fa-trash",cssClass:e,onClick:function(a){t.permissao_alterar&&t.grid_emails_acompanhamento.deleteRow(a.row.rowIndex)}}]}]}).dxDataGrid("instance")},this.evt_alterar_cliente=function(){switch(t.filtros=spread({},t.filtros,{cliente_id:t.cboClientes.props.ClienteSelecionado.id,cliente_nome:t.cboClientes.props.ClienteSelecionado.nome_fantasia,cliente_tipo:t.cboClientes.props.ClienteSelecionado.tipo}),t.div_atividade_projeto.addClass("hidden"),t.projeto_atividade_id=null,t.evento_projeto_id=null,set_value_combobox(t.cbo_evento_projeto,null,""),t.filtros.cliente_tipo){case"C":t.evento_cliente_id=t.filtros.cliente_id,t.evento_empresa_id=null,t.evento_prospect_id=null,t.evento_fornecedor_id=null,t.div_projeto.removeClass("hidden"),t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.CLIENTE;break;case"E":t.evento_empresa_id=t.filtros.cliente_id,t.evento_cliente_id=null,t.evento_prospect_id=null,t.evento_fornecedor_id=null,t.div_projeto.addClass("hidden"),t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.EMPRESA;break;case"O":t.evento_prospect_id=t.filtros.cliente_id,t.evento_empresa_id=null,t.evento_cliente_id=null,t.evento_fornecedor_id=null,t.div_projeto.addClass("hidden"),t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.PROSPECT;break;case"F":t.evento_fornecedor_id=t.filtros.cliente_id,t.evento_empresa_id=null,t.evento_prospect_id=null,t.evento_cliente_id=null,t.div_projeto.addClass("hidden"),t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.FORNECEDOR}},this.renderiza_componentes=function(){t.renderiza_combobox_cliente(),t.cboClientes.props.setCliente(t.filtros),t.cboClientes.props.setFunctionSelect(t.evt_alterar_cliente)},this.renderiza_combobox_cliente=function(){t.cboClientes.props.initial_values.disabled=t.permite_desabilitar,e.render(t.cboClientes,t.div_component_cbo_clientes[0]),t.cboClientes.props.setConfiguracoes={main_externo:t,exibe_tipo_entidade:!0,WS_params:{limite:0}}},this.render_usuarios=function(a,e){var i=t.tb_convidados.find("tbody"),o=$(i.find('[template-row="convidados"]')),n=function(a,e){var n=o.clone();n.addClass("rows").attr("indice",a).removeAttr("template-row").css("display",""),$(n.find('[template-field="nome"]')).text(e.nome),$(n.find('[template-field="email"]')).text(e.email);var d=$(n.find('[template-button="btn_remover"]'));d.unbind("click"),d.click(function(){e.excluido="S",t.arr_usuarios[a]=e,n.remove()}),n.appendTo(i)};void 0!==e&&!1!==e?a&&a.usuario_id!=t.sel_usuario_id?$(t.arr_usuarios).in_array(a.usuario_id,"usuario_id",function(e,i){"S"==i.excluido&&(n(e,a),a.excluido="N",t.arr_usuarios[e]=a)})||(n(t.arr_usuarios.length,a),t.arr_usuarios.push(a)):(t.tb_convidados.find(".rows").remove(),$(t.arr_usuarios).each(function(a,e){n(a,e)})):t.validar_relacionados(a)},this.render_historico=function(){var a=t.tab_historico.find("tbody"),e=a.find("[template-row]");WS.get("agenda_evento/listar_historico/",{agenda_evento_id:t.sel_evento_id,limite:t.limite},function(i){$(i).each(function(i,o){!function(i,o){var n=e.clone();n.removeAttr("template-row"),n.css("display",""),n.addClass(".rows"),n.find(".lbl_acao").text(acao_agenda_nome(o.acao)),n.find(".lbl_detalhes").text(o.detalhes),n.find(".lbl_usuario").text(o.usuario_nome),n.find(".lbl_data").text(o.quando.format_date_time()),n.appendTo(a)}(0,o)}),t.div_load.addClass("hidden")})},this.close=function(){close_modal(t.modal.attr("id")),void 0!==t.onclose&&t.onclose&&t.onclose()},this.unload=function(){t.close(),View.unload(this.html_id)},this.limpar_evento=function(a){t.filtros=spread({},t.filtros,{cliente_id:"",cliente_nome:"",cliente_tipo:""}),t.edt_evento_dia.val(""),t.edt_evento_inicio_instance.option("value","object"==typeof a&&"string"==typeof a.hora_inicio&&""!=a.hora_inicio.trim()&&"00:00"!=a.hora_inicio.substr(0,5)?a.hora_inicio:"08:00"),t.edt_evento_fim_instance.option("value","object"==typeof a&&"string"==typeof a.hora_fim&&""!=a.hora_fim.trim()&&"00:00"!=a.hora_fim.substr(0,5)?a.hora_fim:"18:00"),t.cbo_evento_tipo_agenda.val(""),t.cbo_evento_local.val(""),set_value_combobox(t.cbo_evento_projeto,null,""),t.edt_titulo.val("")},this.permite_alterar=function(a,e){t.permite_desabilitar=!a,t.edt_evento_dia.prop("readonly",!a),t.edt_evento_inicio_instance.option("readonly",!a),t.edt_evento_fim_instance.option("readonly",!a),t.cbo_evento_tipo_agenda.prop("disabled",!a),t.cbo_evento_local.prop("disabled",!a),t.cbo_evento_tipo.parent().find(".edt_combobox").prop("readonly",!a),t.cbo_evento_tipo.parent().find("button").prop("disabled",!a),t.cbo_evento_cliente.prop("disabled",!a),t.edt_titulo.prop("readonly",!a),t.tb_convidados.find('[template-button="btn_remover"]').prop("disabled",!a),t.edt_quantidade_diario.prop("disabled",!a),t.edt_quantidade_semanal.prop("disabled",!a),t.chk_mensal_domingo.prop("disabled",!a),t.chk_mensal_segunda.prop("disabled",!a),t.chk_mensal_terca.prop("disabled",!a),t.chk_mensal_quarta.prop("disabled",!a),t.chk_mensal_quinta.prop("disabled",!a),t.chk_mensal_sexta.prop("disabled",!a),t.chk_mensal_sabado.prop("disabled",!a),t.edt_dia_mes.prop("disabled",!a),t.edt_qtde_mes.prop("disabled",!a),t.cbo_numero_da_semana.prop("disabled",!a),t.cbo_dia_semana.prop("disabled",!a),t.edt_mensal_qtde.prop("disabled",!a),t.edt_quantidade_ano.prop("disabled",!a),t.cbo_anual_meses.prop("disabled",!a),t.edt_anual_dia.prop("disabled",!a),t.cbo_anual_numero_da_semana.prop("disabled",!a),t.cbo_anual_dia_semana.prop("disabled",!a),t.cbo_anual_meses2.prop("disabled",!a),t.edt_data_inicial.prop("disabled",!a),t.div_radio_tipo_recorrencia.find("input").prop("disabled",!a),t.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!a),t.edt_horas_recorrencia.prop("disabled",!a),t.div_intervalo_recorrencia.prop("disabled",!a),t.edt_data_final.prop("disabled",!a),t.chk_realizado.prop("disabled",!e&&!a),t.chk_dia_inteiro.prop("disabled",!a),t.edt_evento_notificar_antes.prop("disabled",!a),t.chk_notificar_envolvidos.prop("disabled",!a),a?(t.btn_excluir.show(),t.btn_confirmar.show(),t.div_componente_convidado.removeClass("hidden")):(t.btn_excluir.hide(),e||(t.btn_confirmar.hide(),t.btn_ok.text("Ok")),t.div_componente_convidado.addClass("hidden"));var i=t.cbo_evento_projeto.parent(),o=i.find(".edt_combobox"),n=i.find("button");o.attr("disabled",!a),o.attr("readonly",!a),n.attr("disabled",!a)},this.preencher=function(){WS.get("agenda_evento/objeto/",{agenda_evento_id:t.sel_evento_id},function(a){t.permissao_manutencao_agenda_ativo=a.permissao_manutencao_agenda_ativo,t.agenda_ativo_id=+a.agenda_ativo_id;var e={manutencao_propria_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),manutencao_agenda:App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),manutencao_agenda_ativo:App.verifica_permissao(App.temp.empresa,"manutencao_agenda_ativo")&&("S"==t.permissao_manutencao_agenda_ativo||"P"==t.permissao_manutencao_agenda_ativo&&+a.insert_usuario_id==App.sessao.dados.usuario_id)},i=App.sessao.dados.admin||!(+t.agenda_ativo_id>0)&&e.manutencao_agenda||!(+t.agenda_ativo_id>0)&&e.manutencao_propria_agenda&&+a.usuario_id>0&&+a.usuario_id==App.sessao.dados.usuario_id||+t.agenda_ativo_id>0&&e.manutencao_agenda_ativo;t.atuacao_efetiva_resultado_esperado_id=a.atuacao_efetiva_resultado_esperado_id,t.competencias_essenciais_resultado_esperado_id=a.competencias_essenciais_resultado_esperado_id,i&&a.agenda_recorrente?parseInt(a.agenda_recorrente.tipo_recorrencia)==TIPO_AGENDA_RECORRENTE.NENHUMA||t.forcar_evento_dia?(t.forcar_evento_dia||(t.tipo_reprogramacao=1),show_modal(t.modal.attr("id"))):(t.evento_possui_recorrencia=!0,View.load("agenda/reprogramar_agenda_recorrente",function(a,e){e.onsave=function(a){t.tipo_reprogramacao=a,e.unload(),show_modal(t.modal.attr("id"))},e.show()})):show_modal(t.modal.attr("id")),t.sel_usuario_id=a.usuario_id,t.arr_usuarios=a.arr_convidados;var o="";if(o=+t.agenda_ativo_id>0?t.usuario_nome||a.agenda_ativo_nome||"":a.usuario_nome,t.title.html(" "+App.lang.gestao_agenda.evento+' <span class="small">'+o+"</span>"),t.permite_alterar(i,t.convidado_evento),a.tipo_atuacao>0)switch(a.tipo_atuacao){case TIPO_RESULTADO.INFORMATIVO:t.div_valor.addClass("hidden"),t.div_percentual.addClass("hidden");break;case TIPO_RESULTADO.PERCENTUAL:t.div_valor.addClass("hidden"),t.div_percentual.removeClass("hidden"),t.edt_percentual_atuacao.removeClass("hidden"),t.edt_percentual_atuacao.val(a.percentual_alcancado_atuacao);break;case TIPO_RESULTADO.VALOR:t.div_valor.removeClass("hidden"),t.div_percentual.addClass("hidden"),t.edt_valor_atuacao.removeClass("hidden"),t.edt_valor_atuacao.val(a.valor_alcancado_atuacao)}else switch(a.tipo_competencia){case TIPO_RESULTADO.INFORMATIVO:t.div_valor.addClass("hidden"),t.div_percentual.addClass("hidden");break;case TIPO_RESULTADO.PERCENTUAL:t.div_valor.addClass("hidden"),t.div_percentual.removeClass("hidden"),t.edt_percentual_competencia.removeClass("hidden"),t.edt_percentual_competencia.val(a.percentual_alcancado_competencia);break;case TIPO_RESULTADO.VALOR:t.div_valor.removeClass("hidden"),t.edt_percentual_competencia.addClass("hidden"),t.edt_valor_competencia.removeClass("hidden"),t.edt_valor_competencia.val(a.valor_alcancado_competencia)}if(0==+a.agenda_ativo_id)i||t.sel_usuario_id==App.sessao.usuario_id&&(t.chk_realizado.prop("disabled",!1),t.btn_confirmar.show(),t.somente_realizado=!0,t.btn_ok.text("Cancelar"));else if(t.menu_convidados.addClass("hidden"),t.menu_responsavel.removeClass("hidden"),!i){var n=!1;try{a.arr_convidados.filter(function(a){return+a.usuario_id==App.sessao.usuario_id}).length>0&&(n=!0)}catch(a){n=!1}n&&(t.chk_realizado.prop("disabled",!1),t.btn_confirmar.show(),t.somente_realizado=!0,t.btn_ok.text("Cancelar"))}t.render_usuarios(a,!0),(t.sel_usuario_id==App.sessao.usuario_id||!0===App.sessao.dados.admin||App.verifica_permissao(App.temp.empresa,"visualizar_historico"))&&(t.lbl_tab_historico.removeClass("hidden"),t.render_historico()),set_datepicker(t.edt_evento_dia,a.dia),null!=a.hora_inicio&&null!=a.hora_fim&&(t.edt_evento_inicio_instance.option("value",a.hora_inicio.substr(0,5)),t.edt_evento_fim_instance.option("value",a.hora_fim.substr(0,5))),null!=a.notificar_antes&&t.edt_evento_notificar_antes.val(a.notificar_antes.substr(0,5)),t.chk_dia_inteiro.prop("checked",a.dia_inteiro).change(),t.listar_tipo_agenda(a.agenda_tipo_id),t.listar_local_agenda(a.agenda_local_id),t.arrAtivosSelecionados=a.arr_ativos,t.initSelecaoAtivos(),t.evento_projeto_id=a.projeto_id,t.evento_cliente_id=a.cliente_id,t.evento_empresa_id=a.empresa_id,t.evento_prospect_id=a.prospect_id,t.evento_fornecedor_id=a.fornecedor_id,t.projeto_atividade_id=a.projeto_atividade_id,a.cliente_id>0?(t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.CLIENTE,t.div_projeto.removeClass("hidden"),set_value_combobox(t.cbo_evento_tipo,a.cliente_id,a.cliente_nome),t.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_cliente),t.filtros=spread({},t.filtros,{cliente_id:a.cliente_id,cliente_nome:a.cliente_nome,cliente_tipo:"C"})):a.fornecedor_id>0?(t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.FORNECEDOR,set_value_combobox(t.cbo_evento_tipo,a.fornecedor_id,a.fornecedor_nome),t.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_fornecedor),t.filtros=spread({},t.filtros,{cliente_id:a.fornecedor_id,cliente_nome:a.fornecedor_nome,cliente_tipo:"F"})):a.prospect_id>0?(t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.PROSPECT,set_value_combobox(t.cbo_evento_tipo,a.prospect_id,a.prospect_nome),t.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_organizacao),t.filtros=spread({},t.filtros,{cliente_id:a.prospect_id,cliente_nome:a.prospect_nome,cliente_tipo:"O"})):a.empresa_id>0&&(t.envolvido_tipo=AGENDA_EVENTO_ENVOLVIDO_TIPO.EMPRESA,set_value_combobox(t.cbo_evento_tipo,a.empresa_id,a.empresa_nome),t.cbo_evento_tipo.parent().find(".edt_combobox").attr("placeholder",App.lang.combobox.selecione_empresa),t.filtros=spread({},t.filtros,{cliente_id:a.empresa_id,cliente_nome:a.empresa_nome,cliente_tipo:"E"})),t.renderiza_componentes(),set_value_combobox(t.cbo_evento_projeto,a.projeto_id,a.projeto_nome),a.projeto_id>0?t.div_atividade_projeto.removeClass("hidden"):t.div_atividade_projeto.addClass("hidden"),t.preencher_atividade_projeto([],a.atividade_simplificada),t.evento_projeto_id&&t.listar_atividades_projeto(t.evento_projeto_id),t.edt_titulo.val(a.descricao),set_tinymce(t.edt_evento_descricao,a.descricao_detalhada,t.permite_desabilitar),t.chk_realizado.prop("checked","S"===a.realizado).change(),t.chk_notificar_envolvidos.prop("checked",!0).change(),a.agenda_recorrente?(0==a.agenda_recorrente.tipo_recorrencia?t.div_intervalo_recorrencia_geral.addClass("hidden"):t.div_intervalo_recorrencia_geral.removeClass("hidden"),t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="'+a.agenda_recorrente.tipo_recorrencia+'"]').prop("checked",!0),t.div_diario.find('input[name="opt_radio_diario"][value="'+parseInt(a.agenda_recorrente.diario_tipo_recorrencia)+'"]').prop("checked",!0),t.edt_quantidade_diario.val(a.agenda_recorrente.diario_quantidade_dias),t.edt_quantidade_semanal.val(a.agenda_recorrente.mensal_quantidade_semanas),t.chk_mensal_domingo.prop("checked",a.agenda_recorrente.mensal_domingo),t.chk_mensal_segunda.prop("checked",a.agenda_recorrente.mensal_segunda),t.chk_mensal_terca.prop("checked",a.agenda_recorrente.mensal_terca),t.chk_mensal_quarta.prop("checked",a.agenda_recorrente.mensal_quarta),t.chk_mensal_quinta.prop("checked",a.agenda_recorrente.mensal_quinta),t.chk_mensal_sexta.prop("checked",a.agenda_recorrente.mensal_sexta),t.chk_mensal_sabado.prop("checked",a.agenda_recorrente.mensal_sabado),t.div_mensal.find('input[name="opt_radio_mensal"][value="'+a.agenda_recorrente.mensal_tipo_recorrencia+'"]').prop("checked",!0),t.edt_dia_mes.val(a.agenda_recorrente.mensal_dia),t.edt_qtde_mes.val(a.agenda_recorrente.mensal_quantidade_meses),t.cbo_numero_da_semana.val(a.agenda_recorrente.mensal_numero_da_semana),t.cbo_dia_semana.val(a.agenda_recorrente.mensal_dia_da_semana),t.edt_mensal_qtde.val(a.agenda_recorrente.mensal_quantidade_meses2),t.div_anual.find('input[name="opt_radio_anual"][value="'+a.agenda_recorrente.anual_tipo_recorrencia+'"]').prop("checked",!0),t.edt_quantidade_ano.val(a.agenda_recorrente.anual_quantidade_anos),t.cbo_anual_meses.val(a.agenda_recorrente.anual_mes),t.edt_anual_dia.val(a.agenda_recorrente.anual_dia),t.cbo_anual_numero_da_semana.val(a.agenda_recorrente.anual_numero_da_semana),t.cbo_anual_dia_semana.val(a.agenda_recorrente.anual_dia_da_semana),t.cbo_anual_meses2.val(a.agenda_recorrente.anual_mes2),t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="'+a.agenda_recorrente.intervalo_recorrencia_tipo_termino+'"]').prop("checked",!0),set_datepicker(t.edt_data_inicial,a.agenda_recorrente.intervalo_recorrencia_data_inicial),t.edt_intervalo_recorrencia_quantidade_dias.val(a.agenda_recorrente.intervalo_recorrencia_quantidade_ocorrencias),set_datepicker(t.edt_data_final,a.agenda_recorrente.intervalo_recorrencia_data_termino),t.edt_horas_recorrencia.val(a.agenda_recorrente.intervalo_recorrencia_horas_termino),t.chk_utiliza_calendario_trabalho.prop("checked",a.agenda_recorrente.utiliza_calendario_trabalho),t.chk_utiliza_calendario_trabalho.removeClass("template_switch"),App.aplicar_checkbox(t.div_horas)):t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').prop("checked",!0),t.inicializa_componentes(a),t.div_radio_tipo_recorrencia.change()},[t.btn_confirmar])},this.listar_tipo_agenda=function(a){t.cbo_evento_tipo_agenda.find("option").remove(),add_option(t.cbo_evento_tipo_agenda,"",App.lang.selectpicker.selecionar),WS.get("tipo_agenda/listar/",null,function(e){for(var i=0;i<e.length;i++){var o=e[i];add_option(t.cbo_evento_tipo_agenda,o.tipo_agenda_id,o.nome)}a&&t.cbo_evento_tipo_agenda.val(a).trigger("change"),t.cbo_evento_tipo_agenda.selectpicker("refresh")})},this.listar_local_agenda=function(a){t.cbo_evento_local.find("option").remove(),add_option(t.cbo_evento_local,"",App.lang.selectpicker.selecionar),WS.get("local_agenda/listar/",null,function(e){for(var i=0;i<e.data.length;i++){var o=e.data[i];add_option(t.cbo_evento_local,o.id,o.nome)}a&&t.cbo_evento_local.val(a).trigger("change"),t.cbo_evento_local.selectpicker("refresh")})},this.function_select_projeto=function(a){t.evento_projeto_id!=a.id&&(t.projeto_atividade_id=null),t.evento_projeto_id=a.id,a.id>0?(t.div_atividade_projeto.removeClass("hidden"),t.listar_atividades_projeto(a.id)):t.div_atividade_projeto.addClass("hidden")},this.listar_projeto=function(a){var e=t.cbo_evento_projeto.parent().find(".edt_combobox");WS.get("projeto/listar/",{cliente_id:t.evento_cliente_id,nome:e.val(),ignorar_concluidos:!0,limite:0},function(e){if(limpar_combobox(t.cbo_evento_projeto),e.length){for(var i=0;i<e.length;i++){var o=e[i],n=[];n.Nome=o.nome,add_option_combobox(t.cbo_evento_projeto,i,o.id>0?o.id:null,n,null,JSON.stringify(o))}a(!0)}$(t.cbo_evento_projeto.parent()).find(".ul_row").click(function(){var a=$(this).parent().attr("dados-adicionais")?JSON.parse($(this).parent().attr("dados-adicionais")):null;t.function_select_projeto(a)}),t.cbo_evento_projeto.parent().find(".edt_combobox").keypress(function(a){if(13==a.keyCode){var e=$(this).attr("dados-adicionais")?JSON.parse($(this).attr("dados-adicionais")):null;t.function_select_projeto(e)}})}),e.keyup(function(a){$(this).val()||t.function_select_projeto({})})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){t.unload()}),this.btn_confirmar.unbind("click"),this.btn_confirmar.click(function(){if(t.emails_acompanhamento=t.grid_emails_acompanhamento.getDataSource().store()._array.map(function(a,e){return a.email}),d(t.edt_horas_recorrencia.val())&&d(t.edt_evento_inicio_instance.option("value"))&&d(t.edt_evento_fim_instance.option("value"))&&_(t.edt_evento_inicio_instance.option("value"),t.edt_evento_fim_instance.option("value"))){var a={tipo_recorrencia:t.div_radio_tipo_recorrencia.find(":checked").val()>0?t.div_radio_tipo_recorrencia.find(":checked").val():"",diario_tipo_recorrencia:t.div_diario.find(":checked").val()>0?t.div_diario.find(":checked").val():"",diario_quantidade_dias:t.edt_quantidade_diario.val(),mensal_quantidade_semanas:t.edt_quantidade_semanal.val(),mensal_domingo:t.chk_mensal_domingo.prop("checked"),mensal_segunda:t.chk_mensal_segunda.prop("checked"),mensal_terca:t.chk_mensal_terca.prop("checked"),mensal_quarta:t.chk_mensal_quarta.prop("checked"),mensal_quinta:t.chk_mensal_quinta.prop("checked"),mensal_sexta:t.chk_mensal_sexta.prop("checked"),mensal_sabado:t.chk_mensal_sabado.prop("checked"),mensal_tipo_recorrencia:t.div_mensal.find('input[name="opt_radio_mensal"]:checked').val()>0?t.div_mensal.find('input[name="opt_radio_mensal"]:checked').val():"",mensal_dia:t.edt_dia_mes.val(),mensal_quantidade_meses:t.edt_qtde_mes.val(),mensal_numero_da_semana:t.cbo_numero_da_semana.val(),mensal_dia_da_semana:t.cbo_dia_semana.val(),mensal_quantidade_meses2:t.edt_mensal_qtde.val(),anual_tipo_recorrencia:t.div_anual.find('input[name="opt_radio_anual"]:checked').val()>0?t.div_anual.find('input[name="opt_radio_anual"]:checked').val():"",anual_quantidade_anos:t.edt_quantidade_ano.val(),anual_mes:t.cbo_anual_meses.val(),anual_dia:t.edt_anual_dia.val(),anual_numero_da_semana:t.cbo_anual_numero_da_semana.val(),anual_dia_da_semana:t.cbo_anual_dia_semana.val(),anual_mes2:t.cbo_anual_meses2.val(),intervalo_recorrencia_data_inicial:get_datepicker(t.edt_data_inicial),intervalo_recorrencia_tipo_termino:t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val()>0?t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val():"",intervalo_recorrencia_quantidade_ocorrencias:t.edt_intervalo_recorrencia_quantidade_dias.val(),intervalo_recorrencia_data_termino:get_datepicker(t.edt_data_final),intervalo_recorrencia_horas_termino:t.edt_horas_recorrencia.val(),utiliza_calendario_trabalho:t.chk_utiliza_calendario_trabalho.prop("checked")},e={agenda_evento_id:t.sel_evento_id,usuario_id:t.sel_usuario_id,dia:get_datepicker(t.edt_evento_dia),hora_inicio:!0!==t.chk_dia_inteiro.prop("checked")?t.edt_evento_inicio_instance.option("value"):"00:00",hora_fim:!0!==t.chk_dia_inteiro.prop("checked")?t.edt_evento_fim_instance.option("value"):"23:59",notificar_antes:!0!==t.chk_dia_inteiro.prop("checked")?t.edt_evento_notificar_antes.val():"00:00",agenda_tipo_id:t.cbo_evento_tipo_agenda.val(),arr_ativos:JSON.stringify(t.arrAtivosSelecionados),descricao:t.edt_titulo.val(),descricao_detalhada:get_tinymce(t.edt_evento_descricao),agenda_recorrente:a,tipo_reprogramacao:t.tipo_reprogramacao,arr_convidados:JSON.stringify(t.arr_usuarios),realizado:t.chk_realizado.bootstrapSwitch("state"),agenda_ativo_id:t.agenda_ativo_id,calendario_trabalho_id:t.calendario_trabalho_id,valor_alcancado_atuacao:t.edt_valor_atuacao.maskMoney("unmasked")[0],valor_alcancado_competencia:t.edt_valor_competencia.maskMoney("unmasked")[0],percentual_alcancado_atuacao:t.edt_percentual_atuacao.val(),percentual_alcancado_competencia:t.edt_percentual_competencia.val(),atuacao_efetiva_resultado_esperado_id:t.atuacao_efetiva_resultado_esperado_id,competencias_essenciais_resultado_esperado_id:t.competencias_essenciais_resultado_esperado_id,convidado_evento:t.convidado_evento,evento_pessoal:t.evento_pessoal,dia_inteiro:t.chk_dia_inteiro.prop("checked"),emails_acompanhamento:JSON.stringify(t.emails_acompanhamento),notificar_envolvidos:t.chk_notificar_envolvidos.bootstrapSwitch("state"),agenda_local_id:t.evento_pessoal?null:t.cbo_evento_local.val(),cliente_id:t.evento_pessoal?null:t.evento_cliente_id,projeto_id:t.evento_pessoal?null:t.evento_projeto_id,projeto_atividade_id:t.evento_pessoal?null:t.div_componente_atividades.find(".div_listagem_atividade_projeto").attr("id"),fornecedor_id:t.evento_pessoal?null:t.evento_fornecedor_id,prospect_id:t.evento_pessoal?null:t.evento_prospect_id,empresa_id:t.evento_pessoal?null:t.evento_empresa_id,referencia_tabela:t.referencia_tabela,referencia_id:t.referencia_id},i=function(a){var i=App.verifica_permissao(App.temp.empresa,"manutencao_propria_agenda"),o=App.verifica_permissao(App.temp.empresa,"manutencao_agenda"),n=function(e){WS.post({route:"agenda_evento/salvar",type:"POST",data:e,func_response:function(e){void 0!==t.onsave&&t.onsave&&t.onsave(),void 0!==a&&null!=a&&a(e)},func_fail:function(a){t.btn_confirmar.removeClass("disabled").removeAttr("disabled"),t.btn_cancelar.removeClass("disabled").removeAttr("disabled")},disable_buttons:[t.btn_confirmar,t.btn_excluir]})};!t.convidado_evento||i||o?WS.get("agenda_ativo/get_parametros/",null,function(a){0==a.eventos_simultaneos?WS.get("agenda_evento/validar_agenda_ativo/",{agenda_evento_id:e.agenda_evento_id,agenda_ativo_id:e.agenda_ativo_id,hora_inicio:e.hora_inicio,hora_fim:e.hora_fim,dia:e.dia},function(a){1==a?alert_modal("Agenda ativo","Este ativo não está disponível no horário selecionado, por favor, escolha outro horário.","Ok",function(){}):n(e)}):WS.get("agenda_evento/validar_agenda_ativo/",{agenda_evento_id:e.agenda_evento_id,agenda_ativo_id:e.agenda_ativo_id,hora_inicio:e.hora_inicio,hora_fim:e.hora_fim,dia:e.dia},function(a){1==a?alert_modal("Agenda ativo","Este ativo não está disponível no horário selecionado, Deseja continuar?","Sim",function(){n(e)},!0,"Não",function(){}):n(e)})}):n(e)},o=function(){if(t.somente_realizado||a.tipo_recorrencia==TIPO_AGENDA_RECORRENTE.NENHUMA||(!t.evento_possui_recorrencia||e.tipo_reprogramacao==TIPO_REPROGRAMACAO.SOMENTE)&&t.evento_possui_recorrencia)i(function(){t.btn_confirmar.addClass("disabled").attr("disabled","true"),t.btn_cancelar.addClass("disabled").attr("disabled","true"),t.unload()});else if(t.valida_tipo_recorrencia()&&t.valida_intervalo_recorrencia()){var o=function(a){t.btn_confirmar.addClass("disabled").attr("disabled","true"),t.btn_cancelar.addClass("disabled").attr("disabled","true"),View.load("agenda/confirmar_recorrencia",function(i,o){var n={usuario_id:t.sel_usuario_id,agenda_recorrente_id:a.agenda_recorrente.id,agenda_ativo_id:a.agenda_ativo_id,agenda_evento_origem_id:a.id,tipo_reprogramacao:e.tipo_reprogramacao,dia_evento:t.dia_evento,hora_inicio:!0!==t.chk_dia_inteiro.prop("checked")?t.edt_evento_inicio_instance.option("value"):"00:00",hora_fim:!0!==t.chk_dia_inteiro.prop("checked")?t.edt_evento_fim_instance.option("value"):"23:59"};o.onclose=function(){t.unload()},o.show(n)})};t.evento_id?alert_modal("Alterar recorrência","Tem certeza que deseja aplicar estas alterações nessa recorrência? Esta ação não poderá ser desfeita","Aplicar",function(){i(o)},!0,"Cancelar",function(){}):i(o)}};new Validation;if(t.somente_realizado)o();else WS.post("agenda_evento/validar_evento_agenda/",e,function(a){if(a)if(!1===t.chk_realizado.prop("checked")){var e=new Validation;e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,App.lang.modal_validacao.evento_agenda_data_horario)),alert_modal(App.lang.modal_validacao.validacao,e,App.lang.modal_validacao.sim,function(){o()},!0,App.lang.modal_validacao.nao,null,function(){t.btn_confirmar.removeClass("disabled").removeAttr("disabled"),t.btn_cancelar.removeClass("disabled").removeAttr("disabled")})}else o();else o()},[t.btn_confirmar,t.btn_excluir])}}),this.validar_relacionados=function(a,e){t.tbl_agenda_usuario.addClass("hidden");var i={tipo_recorrencia:t.div_radio_tipo_recorrencia.find(":checked").val()>0?t.div_radio_tipo_recorrencia.find(":checked").val():"",diario_tipo_recorrencia:t.div_diario.find(":checked").val()>0?t.div_diario.find(":checked").val():"",diario_quantidade_dias:t.edt_quantidade_diario.val(),mensal_quantidade_semanas:t.edt_quantidade_semanal.val(),mensal_domingo:t.chk_mensal_domingo.prop("checked"),mensal_segunda:t.chk_mensal_segunda.prop("checked"),mensal_terca:t.chk_mensal_terca.prop("checked"),mensal_quarta:t.chk_mensal_quarta.prop("checked"),mensal_quinta:t.chk_mensal_quinta.prop("checked"),mensal_sexta:t.chk_mensal_sexta.prop("checked"),mensal_sabado:t.chk_mensal_sabado.prop("checked"),mensal_tipo_recorrencia:t.div_mensal.find('input[name="opt_radio_mensal"]:checked').val()>0?t.div_mensal.find('input[name="opt_radio_mensal"]:checked').val():"",mensal_dia:t.edt_dia_mes.val(),mensal_quantidade_meses:t.edt_qtde_mes.val(),mensal_numero_da_semana:t.cbo_numero_da_semana.val(),mensal_dia_da_semana:t.cbo_dia_semana.val(),mensal_quantidade_meses2:t.edt_mensal_qtde.val(),anual_tipo_recorrencia:t.div_anual.find('input[name="opt_radio_anual"]:checked').val()>0?t.div_anual.find('input[name="opt_radio_anual"]:checked').val():"",anual_quantidade_anos:t.edt_quantidade_ano.val(),anual_mes:t.cbo_anual_meses.val(),anual_dia:t.edt_anual_dia.val(),anual_numero_da_semana:t.cbo_anual_numero_da_semana.val(),anual_dia_da_semana:t.cbo_anual_dia_semana.val(),anual_mes2:t.cbo_anual_meses2.val(),intervalo_recorrencia_data_inicial:get_datepicker(t.edt_data_inicial),intervalo_recorrencia_tipo_termino:t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val()>0?t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"]:checked').val():"",intervalo_recorrencia_quantidade_ocorrencias:t.edt_intervalo_recorrencia_quantidade_dias.val(),intervalo_recorrencia_data_termino:get_datepicker(t.edt_data_final),intervalo_recorrencia_horas_termino:t.edt_horas_recorrencia.val(),utiliza_calendario_trabalho:t.chk_utiliza_calendario_trabalho.prop("checked")},o={agenda_evento_id:t.sel_evento_id,usuario_id:void 0!==a&&a?a.usuario_id:null,arr_ativos:void 0!==e&&e?JSON.stringify(e):null,dia:get_datepicker(t.edt_evento_dia),hora_inicio:t.edt_evento_inicio_instance.option("value"),hora_fim:t.edt_evento_fim_instance.option("value"),agenda_tipo_id:t.cbo_evento_tipo_agenda.val(),agenda_local_id:t.cbo_evento_local.val(),cliente_id:t.evento_cliente_id,projeto_id:t.cbo_evento_projeto.val(),descricao:t.edt_evento_descricao.val(),descricao_detalhada:get_tinymce(t.edt_evento_descricao),projeto_atividade_id:t.div_componente_atividades.find(".div_listagem_atividade_projeto").attr("id"),fornecedor_id:t.evento_fornecedor_id,prospect_id:t.evento_prospect_id,empresa_id:t.evento_empresa_id,agenda_recorrente:i,tipo_reprogramacao:t.tipo_reprogramacao,arr_convidados:JSON.stringify(t.arr_usuarios),evento_pessoal:t.evento_pessoal,ignorar_validacao:!0};WS.post("agenda_evento/validar_evento_agenda/",o,function(i){const o=()=>{void 0!==a&&a&&a.usuario_id&&t.render_usuarios(a,!0),void 0!==e&&Array.isArray(e)&&(t.arrAtivosSelecionados=e,t.renderSelecaoAtivos())};i?View.load("agenda/modal_info",function(i,n){n.show(get_datepicker(t.edt_evento_dia),a&&a.usuario_id?[a.usuario_id]:null,e||null);n.onclose=function(a){a?o():t.renderSelecaoAtivos()}}):o()})},this.preencher_atividade_projeto=function(a,i){e.render(t.ListarAtividadeProjeto,t.div_componente_atividades[0]),t.ListarAtividadeProjeto.props.setParams({div:t.div_componente_atividades,html_id:t.html_id,data:a,dialog:t.dialog,dropdown:!0,dropdown_disabled:t.permite_desabilitar,somente_leitura:!0,atividade_selecionada:i,parametro_usuario:"atividade_projeto_agenda"})},this.listar_atividades_projeto=function(a){WS.get({route:"atividade_projeto/listar/",data:{projeto_id:a},func_response:function(a){a.atividades.push({atividade_simplificada:a.projeto.nome,id:"raiz",projeto_atividade_sintetica_pai_id:null,tipo_atividade:"P",marco:!1,horas_previstas:"000:00"}),t.preencher_atividade_projeto(a,t.projeto_atividade_id)},html_id:t.html_id})},this.render_referencias=function(){e.unmountComponentAtNode(t.gridReferencias[0]),e.render(a.createElement(window.components.Referencias.default,{tabela:"agenda_evento",id:t.sel_evento_id,callbackBtns(){t.unload()}}),t.gridReferencias[0])},this.aba_historico.unbind("scroll"),this.aba_historico.scroll(function(){t.aba_historico.scrollTop()+t.aba_historico.height()==t.aba_historico.get(0).scrollHeight&&(t.div_load.removeClass("hidden"),t.limite=t.limite+50,t.render_historico())}),this.lbl_tab_referencias.on("click",()=>{t.render_referencias()}),this.btn_excluir.unbind("click"),this.btn_excluir.click(function(){var a={agenda_evento_id:t.sel_evento_id,tipo_reprogramacao:t.tipo_reprogramacao};WS.post("agenda_evento/excluir",a,function(a){void 0!==t.onsave&&t.onsave&&t.onsave(),alert_saved(App.lang.alert_saved.agenda_evento+a.id+App.lang.alert_saved.excluido),t.unload()})}),this.div_radio_tipo_recorrencia.unbind("change"),this.div_radio_tipo_recorrencia.change(function(){switch(t.div_diario.addClass("hidden"),t.div_semanal.addClass("hidden"),t.div_mensal.addClass("hidden"),t.div_anual.addClass("hidden"),parseInt(t.div_radio_tipo_recorrencia.find(":checked").val())){case TIPO_AGENDA_RECORRENTE.NENHUMA:break;case TIPO_AGENDA_RECORRENTE.DIARIO:t.div_diario.removeClass("hidden"),void 0===t.div_diario.find('input[name="opt_radio_diario"]').val()&&t.div_diario.find('input[name="opt_radio_diario"][value="1"]').prop("checked",!0);break;case TIPO_AGENDA_RECORRENTE.SEMANAL:t.div_semanal.removeClass("hidden");break;case TIPO_AGENDA_RECORRENTE.MENSAL:t.div_mensal.removeClass("hidden"),void 0===t.div_mensal.find('input[name="opt_radio_mensal"]').val()&&t.div_mensal.find('input[name="opt_radio_mensal"][value="1"]').prop("checked",!0);break;case TIPO_AGENDA_RECORRENTE.ANUAL:t.div_anual.removeClass("hidden"),void 0===t.div_anual.find('input[name="opt_radio_anual"]').val()&&t.div_anual.find('input[name="opt_radio_anual"][value="1"]').prop("checked",!0)}}),this.cbo_evento_tipo_agenda.unbind("change").change(function(){WS.get("tipo_agenda/objeto/",{tipo_agenda_id:$(this).val()},function(a){("S"==a.particular||1==a.particular?(t.div_local_agenda.hide(),t.div_dados_projeto.hide(),t.evento_pessoal=!0):(t.div_local_agenda.show(),t.div_dados_projeto.show(),t.evento_pessoal=!1),a.notificar_antes&&(+t.evento_tipo_agenda_id>0||t.evento_id&&0===+t.evento_id.evento_id))&&(""!==t.edt_evento_notificar_antes.val()&&a.notificar_antes.substr(0,5)!==t.edt_evento_notificar_antes.val()?DevExpress.ui.dialog.confirm("Deseja definir a notificação para "+a.notificar_antes.substr(0,5)+" antes do evento?","Notificar Antes").done(function(e){e&&t.edt_evento_notificar_antes.val(a.notificar_antes?a.notificar_antes.substr(0,5):"")}):t.edt_evento_notificar_antes.val(a.notificar_antes?a.notificar_antes.substr(0,5):""));t.evento_tipo_agenda_id=a.id},[t.btn_confirmar,t.btn_excluir])}),this.exibir_edt_hora=function(){1==t.chk_dia_inteiro.prop("checked")?(t.div_evento_inicio.hide(),t.div_evento_fim.hide(),t.edt_evento_inicio.hide(),t.edt_evento_fim.hide(),t.div_evento_notificar_antes.hide(),t.edt_evento_notificar_antes.hide()):(t.div_evento_inicio.show(),t.div_evento_fim.show(),t.edt_evento_inicio.show(),t.edt_evento_fim.show(),t.div_evento_notificar_antes.show(),t.edt_evento_notificar_antes.show())},this.chk_dia_inteiro.unbind("change").change(function(){t.exibir_edt_hora()});var d=function(a){var e=new Validation,i=a.split(":"),o=i[1];i.length;if(o>59||a.length>0&&6!=a.length&&5!=a.length)return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" inválido!')),alert_modal(App.lang.modal_validacao.validacao,e),!1;if(a.length>5){if(a>"838:59")return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" deve ser menor que 838:59 horas!')),alert_modal(App.lang.modal_validacao.validacao,e),!1}else if(a>="24:00")return e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Campo "Horas" deve ser menor que 24:00 horas!')),alert_modal(App.lang.modal_validacao.validacao,e),!1;return!0},_=function(a,e){var i=new Validation;return""==a||""==e?(i.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Preencha a Hora Inicial e/ou Hora Final")),alert_modal(App.lang.modal_validacao.validacao,i),!1):!(a>e)||(i.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"A hora inicial não deve ser maior que a hora final")),alert_modal(App.lang.modal_validacao.validacao,i),!1)};this.inicializa_componentes=function(a){a.agenda_recorrente&&(null!=t.evento_id?void 0!==a&&"0"!=a.agenda_recorrente.tipo_recorrencia&&(t.valida_componentes("opt_radio_diario",a.agenda_recorrente.diario_tipo_recorrencia),t.valida_componentes("opt_radio_mensal",a.agenda_recorrente.mensal_tipo_recorrencia),t.valida_componentes("opt_radio_anual",a.agenda_recorrente.anual_tipo_recorrencia),t.valida_componentes("opt_tipo_intervalo_recorrencia",a.agenda_recorrente.intervalo_recorrencia_tipo_termino)):(t.edt_quantidade_diario.prop("disabled",!0),t.edt_quantidade_diario.prop("disabled",!0),t.edt_quantidade_diario.prop("disabled",!0)))},this.valida_componentes=function(a,e){switch(a){case"opt_radio_diario":"1"==e?(t.edt_quantidade_diario.prop("disabled",!1),t.edt_quantidade_diario.focus()):(t.edt_quantidade_diario.prop("disabled",!0),t.edt_quantidade_diario.val("").change());break;case"opt_radio_mensal":"1"==e?(t.edt_dia_mes.prop("disabled",!1),t.edt_qtde_mes.prop("disabled",!1),t.edt_dia_mes.focus(),t.cbo_numero_da_semana.prop("disabled",!0),t.cbo_dia_semana.prop("disabled",!0),t.edt_mensal_qtde.val(""),t.edt_mensal_qtde.prop("disabled",!0)):"2"==e&&(t.edt_dia_mes.val(""),t.edt_qtde_mes.val(""),t.edt_dia_mes.prop("disabled",!0),t.edt_qtde_mes.prop("disabled",!0),t.cbo_numero_da_semana.prop("disabled",!1),t.cbo_dia_semana.prop("disabled",!1),t.edt_mensal_qtde.prop("disabled",!1));break;case"opt_radio_anual":"1"==e?(t.edt_quantidade_ano.prop("disabled",!1),t.edt_quantidade_ano.focus(),t.cbo_anual_meses.prop("disabled",!0),t.edt_anual_dia.prop("disabled",!0),t.edt_anual_dia.val(""),t.cbo_anual_numero_da_semana.prop("disabled",!0),t.cbo_anual_dia_semana.prop("disabled",!0),t.cbo_anual_meses2.prop("disabled",!0)):"2"==e?(t.edt_quantidade_ano.prop("disabled",!0),t.edt_quantidade_ano.val(""),t.cbo_anual_meses.prop("disabled",!1),t.edt_anual_dia.prop("disabled",!1),t.cbo_anual_numero_da_semana.prop("disabled",!0),t.cbo_anual_dia_semana.prop("disabled",!0),t.cbo_anual_meses2.prop("disabled",!0)):(t.edt_quantidade_ano.prop("disabled",!0),t.edt_quantidade_ano.val(""),t.cbo_anual_meses.prop("disabled",!0),t.edt_anual_dia.prop("disabled",!0),t.edt_anual_dia.val(""),t.cbo_anual_numero_da_semana.prop("disabled",!1),t.cbo_anual_dia_semana.prop("disabled",!1),t.cbo_anual_meses2.prop("disabled",!1));break;case"opt_tipo_intervalo_recorrencia":"1"==e?(t.edt_data_final.prop("disabled",!0),t.edt_horas_recorrencia.prop("disabled",!0),t.chk_utiliza_calendario_trabalho.prop("disabled")||(t.chk_utiliza_calendario_trabalho.prop("checked",!1).change(),t.chk_utiliza_calendario_trabalho.prop("disabled",!0)),t.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!1),t.edt_intervalo_recorrencia_quantidade_dias.focus()):"2"==e?(t.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!0),t.edt_intervalo_recorrencia_quantidade_dias.val("").change(),t.edt_horas_recorrencia.prop("disabled",!0),t.edt_horas_recorrencia.val("").change(),t.chk_utiliza_calendario_trabalho.prop("disabled")||(t.chk_utiliza_calendario_trabalho.prop("checked",!1).change(),t.chk_utiliza_calendario_trabalho.prop("disabled",!0)),t.edt_data_final.prop("disabled",!1),t.edt_data_final.focus()):(t.edt_intervalo_recorrencia_quantidade_dias.prop("disabled",!0),t.edt_intervalo_recorrencia_quantidade_dias.val("").change(),t.edt_data_final.prop("disabled",!0),t.edt_horas_recorrencia.prop("disabled",!1),t.chk_utiliza_calendario_trabalho.prop("disabled",!1),t.edt_horas_recorrencia.focus())}},this.valida_tipo_recorrencia=function(){var a=new Validation;if(t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').is(":checked"))t.div_intervalo_recorrencia_geral.addClass("hidden");else if(t.div_intervalo_recorrencia_geral.removeClass("hidden"),t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="1"]').is(":checked")){if(!(t.div_diario.find('input[name="opt_radio_diario"][value="1"]').is(":checked")||t.div_diario.find('input[name="opt_radio_diario"][value="2"]').is(":checked")))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a periodicidade da recorrência da agenda")),alert_modal(App.lang.modal_validacao.validacao,a),t.div_diario.find('input[name="opt_radio_diario"][value="1"]').prop("checked",!0),setTimeout(function(){t.edt_quantidade_diario.focus()},2e3),!1;if(t.div_diario.find('input[name="opt_radio_diario"][value="1"]').is(":checked")&&""==t.edt_quantidade_diario.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de dias para recorrência")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){t.edt_quantidade_diario.focus()},2e3),!1}else if(t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="2"]').is(":checked")){if(!(""!=t.edt_quantidade_semanal.val()&&parseInt(t.edt_quantidade_semanal.val(),10)>0))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de semanas para recorrência")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){t.edt_quantidade_semanal.focus()},2e3),!1;if(!t.semana_selecionada())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe ao menos um dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="3"]').is(":checked"))if(t.div_mensal.find('input[name="opt_radio_mensal"][value="1"]').is(":checked")){if(""==t.edt_dia_mes.val()||t.edt_dia_mes.val()<1&&t.edt_dia_mes.val()>31)return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"O dia informado deve estar entre 1 e 31.")),alert_modal(App.lang.modal_validacao.validacao,a),setTimeout(function(){t.edt_quantidade_diario.focus()},2e3),!1}else{if(""==t.edt_mensal_qtde.val()&&t.edt_mensal_qtde.val()<"1")return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de mês(meses).")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==t.cbo_numero_da_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==t.cbo_dia_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="4"]').is(":checked"))if(t.div_anual.find('input[name="opt_radio_anual"][value="1"]').is(":checked")){if(""==t.edt_quantidade_ano.val()&&t.edt_quantidade_ano.val()<"1")return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe a quantidade de ano(s).")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(t.div_diario.find('input[name="opt_radio_anual"][value="2"]').is(":checked")){if(""==t.cbo_anual_meses.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==t.edt_anual_dia.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else{if(""==t.cbo_anual_numero_da_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Infome o número da semana no mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==t.cbo_anual_dia_semana.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o dia da semana.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(""==t.cbo_anual_meses2.find("option:selected").text())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Informe o mês.")),alert_modal(App.lang.modal_validacao.validacao,a),!1}return!0},this.semana_selecionada=function(){return!!(t.div_chk_semanal.find(".chk_mensal_domingo").is(":checked")||t.div_chk_semanal.find(".chk_mensal_segunda").is(":checked")||t.div_chk_semanal.find(".chk_mensal_terca").is(":checked")||t.div_chk_semanal.find(".chk_mensal_quarta").is(":checked")||t.div_chk_semanal.find(".chk_mensal_quinta").is(":checked")||t.div_chk_semanal.find(".chk_mensal_sexta").is(":checked")||t.div_chk_semanal.find(".chk_mensal_sabado").is(":checked"))},this.valida_intervalo_recorrencia=function(){var a=new Validation;if(!t.div_radio_tipo_recorrencia.find('input[name="opt_radio_tipo_recorrencia"][value="0"]').is(":checked")){if(!(t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="1"]').is(":checked")||t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="2"]').is(":checked")||t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="3"]').is(":checked")))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Selecione ao menos uma opção para término da recorrência.")),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="1"]').is(":checked")){if(""==t.edt_intervalo_recorrencia_quantidade_dias.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Termina após".')),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(t.div_intervalo_recorrencia.find('input[name="opt_tipo_intervalo_recorrencia"][value="2"]').is(":checked")){if(""==get_datepicker(t.edt_data_final))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Termina dia".')),alert_modal(App.lang.modal_validacao.validacao,a),!1;if(get_datepicker(t.edt_data_final)<get_datepicker(t.edt_data_inicial))return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"A data de término não pode ser menor que a data de início")),alert_modal(App.lang.modal_validacao.validacao,a),!1}else if(""==t.edt_horas_recorrencia.val())return a.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Informe o campo "Horas".')),alert_modal(App.lang.modal_validacao.validacao,a),!1}return!0},this.listar_feriados=function(){WS.get("feriado/listar/",null,function(a){a.length>0&&(t.arr_feriados=a,t.edt_evento_dia.trigger("change"))})},this.edt_evento_dia.on("change",function(){t.arr_feriados.length>0&&t.arr_feriados.forEach(function(a,e){t.edt_evento_dia.val()==a.data_feriado?t.div_info_feriado.show():t.div_info_feriado.hide()})}),t.div_info_feriado.on("click",function(){View.load("agenda/modal_info",function(a,e){e.show(null,null,null,!0,t.arr_feriados.filter(function(a){return a.data_feriado==t.edt_evento_dia.val()}))})}),this.edt_quantidade_diario.keyup(function(){somenteNumeros(this.value,this)}),this.edt_intervalo_recorrencia_quantidade_dias.keyup(function(){somenteNumeros(this.value,this)}),this.edt_quantidade_semanal.keyup(function(){somenteNumeros(this.value,this)}),this.edt_dia_mes.keyup(function(){somenteNumeros(this.value,this)}),this.edt_qtde_mes.keyup(function(){somenteNumeros(this.value,this)}),this.edt_mensal_qtde.keyup(function(){somenteNumeros(this.value,this)}),this.edt_quantidade_ano.keyup(function(){somenteNumeros(this.value,this)}),this.edt_anual_dia.keyup(function(){somenteNumeros(this.value,this)}),this.opt_radio_diario.unbind("click"),this.opt_radio_diario.click(function(){t.valida_componentes("opt_radio_diario",$(this).val())}),this.opt_tipo_intervalo_recorrencia.unbind("click"),this.opt_tipo_intervalo_recorrencia.click(function(){t.valida_componentes("opt_tipo_intervalo_recorrencia",$(this).val())}),this.opt_radio_tipo_recorrencia.unbind("click"),this.opt_radio_tipo_recorrencia.click(function(){"2"==$(this).val()?(setTimeout(function(){t.edt_quantidade_semanal.focus()},900),t.div_intervalo_recorrencia_geral.removeClass("hidden")):"0"==$(this).val()?t.div_intervalo_recorrencia_geral.addClass("hidden"):t.div_intervalo_recorrencia_geral.removeClass("hidden")}),this.opt_radio_mensal.unbind("click"),this.opt_radio_mensal.click(function(){t.valida_componentes("opt_radio_mensal",$(this).val())}),this.opt_radio_anual.unbind("click"),this.opt_radio_anual.click(function(){t.valida_componentes("opt_radio_anual",$(this).val())})}});