define([],function(){return function(i){"use strict";var a=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Competências Essenciais",this.btn_novo=this.dialog.find(".btn_novo"),this.btn_listar=this.dialog.find(".btn_listar"),this.box_atuacao=this.dialog.find(".box_atuacao"),this.boxes=this.dialog.find(".boxes"),this.btn_tutorial=this.dialog.find(".btn_tutorial"),this.btn_limpar_filtro=this.dialog.find(".btn_limpar_filtro"),this.edt_pesq_codigo=this.dialog.find(".edt_pesq_codigo"),this.btn_pesquisa_codigo=this.dialog.find(".btn_pesquisa_codigo"),this.div_cbo_autor=this.dialog.find(".div_cbo_autor"),this.cbo_autor=this.dialog.find(".cbo_autor"),this.cbo_status=this.dialog.find(".cbo_status"),this.filtro={},this.listar=function(i,o){var t=a.box_atuacao;i&&View.load("competencias_essenciais/detalhes",function(i,t){t.onclose=a.listar,t.show(o)}),"S"!=App.sessao.dados.supervisor_empenho&&a.div_cbo_autor.addClass("hidden");a.boxes.empty(),WS.get("competencias_essenciais/listar/",{filtro:a.filtro},function(i){$(i).each(function(i,o){!function(i){var o=t.clone();o.removeAttr("template-box"),o.attr("data-id",i.id),o.css("display",""),$(o.find("[template-field='descricao']")).html(i.descricao),$(o.find("[template-field='id']")).text("#"+i.id),$(o.find("[template-field='autor']")).html("<b>Autor: </b>"+i.autor),$(o.find("[template-field='atuacao_info']")).html("<b>Atuação Efetiva:</b> "+i.nome_funcao+" [N. #"+i.versao_base_atuacao_efetiva+" - Ver. #"+i.versao_controle_atuacao_efetiva+"]"),$(o.find("[template-field='indicador_info']")).html("<b>Meta/KPI:</b> "+i.nome),$(o.find("[template-field='data_inicio']")).html(""==i.data_inicio?"-":"<b>Data Início: </b>"+i.data_inicio.format_date());var e=o.find(".box .box-info, .box .box-header"),s=$(o.find(".btn_excluir")),n=$(o.find(".btn_concluir")),c=$(o.find(".btn_graficos")),d=$(o.find(".btn_editar")),r=function(a){var o=$(this).closest(".box_atuacao").attr("data-id");View.load("competencias_essenciais/passos_competencias_essenciais",function(a,t){t.show(o,i.descricao,i.usuario_id,i.responsabilidade_id,i.atuacao_efetiva_id)},View.ABA.MULTIPLAS)};e.css("cursor","pointer").unbind("click").click(r),d.unbind("click"),d.click(r),o.dblclick(r),s.unbind("click"),s.click(function(i){var o=$(this).closest(".box_atuacao").attr("data-id"),t=new Validation;t.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Tem certeza que deseja excluir?")),alert_modal("Validação",t,"Sim",function(){WS.post("competencias_essenciais/excluir",{competencias_essenciais_id:o},function(i){alert_saved("Excluido com sucesso"),a.listar()})},!0,"Não",null,function(){})}),"S"!=i.concluida&&"S"==App.sessao.dados.supervisor_empenho||n.addClass("hidden"),n.unbind("click"),n.click(function(){alert_modal("Competências Essenciais",'Tem certeza que deseja marcar esta Competência como "Concluída".',"Sim",function(){WS.post("competencias_essenciais/concluir_matriz",{competencias_essenciais_id:i.id},function(i){alert_saved("salvo com sucesso"),a.listar()})},!0,"Não")}),(App.sessao.dados.admin||"S"==App.sessao.dados.supervisor_empenho)&&App.sessao.dados.usuario_id==i.usuario_id&&(o.append("<span style='position: absolute;top: 5px;left: 20px;color: white;'class='glyphicon glyphicon-star'></span>"),e.css({background:"rgb(100, 69, 69)"})),c.unbind("click"),c.click(function(){View.load("graficos_hpe/graficos",function(a,o){o.show(i.id,i.responsabilidade_id,i.atuacao_efetiva_id)},View.ABA.MULTIPLAS)}),o.appendTo(a.boxes)}(o)})})},this.listar_filtro_responsavel=function(i){a.cbo_autor.find("option").remove(),add_option(a.cbo_autor,"-1","Todos"),WS.get("atuacao_efetiva/listar/",{filtro_cbo_autor:!0},function(o){for(var t=0;t<o.length;t++){var e=o[t];add_option(a.cbo_autor,e.usuario_id,e.autor)}i&&a.cbo_autor.val(i).trigger("change"),a.cbo_autor.selectpicker("refresh")})},a.cbo_autor.unbind("change"),a.cbo_autor.change(function(i){a.filtro.usuario_id=a.cbo_autor.val(),a.listar()}),a.btn_limpar_filtro.unbind("click"),a.btn_limpar_filtro.click(function(){a.filtro={},a.cbo_autor.val("-1"),a.cbo_autor.selectpicker("refresh"),a.cbo_status.val("-1"),a.cbo_status.selectpicker("refresh"),a.edt_pesq_codigo.val(""),a.listar()}),a.cbo_status.unbind("change"),a.cbo_status.change(function(i){a.filtro.status=a.cbo_status.val(),a.listar()}),this.btn_tutorial.unbind("click"),this.btn_tutorial.click(function(i){var a=$('<br><br><p><b style="font-size: 25px;">A</b>gora que você concluiu o seu trabalho relacionado a ATUAÇÃO EFETIVA, descobrindo ou reforçando estrategicamente onde você deve colocar ainda mais energia e capital intelectual para fazer mais, melhor, mais rápido e ou com menor custo ou esforço, é chegada a hora de avançarmos para o segundo passo. Entre e aprenda a fazer um mapa das competências essenciais que mais podem lhe ajudar neste momento, baseado nas responsabilidades escolhidas e as ações definidas. </p><br><br><p><b style="font-size: 25px;">C</b>ompetências compreendem um grupo especifico de Conhecimentos, Habilidades e a Atitudes que juntos lhe permitem desempenhar melhor ou pior uma determinada responsabilidade ou tarefa. </p><br><br><p><b style="font-size: 25px;">P</b>or meio da nossa metodologia, será possível definir as competências mais essenciais por resultado a ser atingido, juntamente com planos de ações especificas para o desenvolvimento da mesma. </p><br><br><p><b style="font-size: 25px;">V</b>ocê levará em torno de 30 a 40 minutos para criação da mesma. Em caso de dúvidas, consulte o tutorial ou entre em contato com seu Superior Imediato ou suporte técnico que iremos lhe ajudar. </p>');View.load("atuacao_efetiva/tutorial",function(i,o){o.show(a,"Competências Essenciais","competencia")},View.ABA.NAO)}),a.btn_pesquisa_codigo.unbind("click"),a.btn_pesquisa_codigo.click(function(){a.filtro.codigo_competencia=a.edt_pesq_codigo.val(),a.listar()}),this.btn_novo.unbind("click"),this.btn_novo.click(function(){View.load("competencias_essenciais/detalhes",function(i,o){o.onclose=a.listar,o.show()})}),this.btn_listar.unbind("click"),this.btn_listar.click(function(){a.listar()}),this.unload=function(){View.unload(this.html_id)},a.listar_filtro_responsavel(),App.get_parametro_usuario("empenho").exibir_tutorial_competencia&&this.btn_tutorial.trigger("click")}});