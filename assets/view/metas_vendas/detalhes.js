var isMobile=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),define(["react","react-dom"],function(e,t){return function(i){"use strict";var a=this;this.html_id=i,this.dialog=$("#"+this.html_id),this.title="Detalhes Meta",this.onclose=null,this.onselect=null,this.onsave=null,this.ondelete=null,this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.edt_descricao=this.dialog.find(".edt_descricao"),this.edt_ini=this.dialog.find(".edt_ini"),this.edt_fim=this.dialog.find(".edt_fim"),this.edt_valor=this.dialog.find(".edt_valor"),this.cbo_tipo=this.dialog.find(".cbo_tipo"),this.cbo_funil=this.dialog.find(".cbo_funil"),this.tab_funil_vendas=this.dialog.find(".tab_funil_vendas"),this.cbo_representante=this.dialog.find(".cbo_representante"),this.tab_representante=this.dialog.find(".tab_representante"),this.div_representantes=this.dialog.find(".div_representantes"),this.div_funil_vendas=this.dialog.find(".div_funil_vendas"),this.dx_grid=this.dialog.find(".dx_grid"),this.metas_vendas_id=0,this.arr_funil_vendas=[],this.arr_representantes=[],this.funil_vendas_id=null,this.edt_funil=null,this.representante_id=null,this.edt_representante=null,this.gridEventosRef=null,this.show=function(e,t){set_datepicker(a.edt_ini),set_datepicker(a.edt_fim),a.edt_valor.maskMoney({thousands:".",decimal:",",allowZero:!0,suffix:"",precision:2}),create_combobox(a.cbo_funil,a.listar_funil);var i=a.cbo_funil.parent();a.edt_funil=i.find(".edt_combobox"),a.edt_funil.keypress(function(e){if(13==e.keyCode){var t=a.cbo_funil.parent(),i=t.find(".ncbo_scroll").find(".row_selected").attr("id_registro");a.funil_vendas_id=i,a.salvar_funil_vendas(),t.find(".ncbo_item").removeClass("bg-primary"),t.find(".ncbo_item").removeClass("row_selected")}}),create_combobox(a.cbo_representante,a.listar_representante);i=a.cbo_representante.parent();switch(a.edt_representante=i.find(".edt_combobox"),a.edt_representante.keypress(function(e){if(13==e.keyCode){var t=a.cbo_representante.parent(),i=t.find(".ncbo_scroll").find(".row_selected").attr("id_registro");a.representante_id=i,a.salvar_representante(),t.find(".ncbo_item").removeClass("bg-primary"),t.find(".ncbo_item").removeClass("row_selected")}}),t){case FORMULARIO.NOVO:a.btn_salvar.show(),a.btn_excluir.hide(),App.titulo_aba(a.html_id,"Nova - Meta"),a.permite_alterar(!0),a.tipo_meta("F");break;case FORMULARIO.EDITAR:a.btn_salvar.show(),a.btn_excluir.hide(),a.permite_alterar(!0);break;case FORMULARIO.VISUALIZAR:a.btn_salvar.hide(),a.btn_excluir.hide(),a.permite_alterar(!1);break;case FORMULARIO.EXCLUIR:a.btn_salvar.hide(),a.btn_excluir.show(),a.permite_alterar(!1)}void 0!==e&&e&&(a.metas_vendas_id=e,a.preencher()),a.render_grid_metas_eventos(),set_focus(a.edt_descricao)},this.close=function(){void 0!==a.onclose&&a.onclose&&a.onclose()},this.unload=function(){a.close(),View.unload(this.html_id)},this.permite_alterar=function(e){a.edt_descricao.prop("disabled",!e),a.edt_ini.prop("disabled",!e),a.edt_fim.prop("disabled",!e),a.edt_valor.prop("disabled",!e),a.cbo_tipo.prop("disabled",!e)},this.preencher=function(){WS.get("metas_vendas/objeto/",{metas_vendas_id:a.metas_vendas_id},function(e){App.titulo_aba(a.html_id,"Meta - "+e.descricao),a.edt_descricao.val(e.descricao),set_datepicker(a.edt_ini,e.inicio),set_datepicker(a.edt_fim,e.fim),a.edt_valor.maskMoney("mask",parseFloat(e.valor)),a.cbo_tipo.val(e.tipo),a.tipo_meta(e.tipo),a.arr_funil_vendas=e.arr_funil_vendas,a.listar_funil_vendas_meta(),a.arr_representantes=e.arr_representantes,a.listar_representantes_meta()})},this.listar_funil=function(e){var t=new Object;t.nome=a.edt_funil.val(),WS.get("funil_vendas/listar/",t,function(t){limpar_combobox(a.cbo_funil),$(t).each(function(e,t){var i=[];i["Descrição"]=t.nome,add_option_combobox(a.cbo_funil,e,t.id,i)}),a.cbo_funil.parent().find(".ul_row").click(function(){var e=$(this).parent().attr("id_registro");a.funil_vendas_id=e,a.salvar_funil_vendas()}),e(!0)})},this.listar_representante=function(e){var t={nome_fantasia:a.edt_representante.val()};WS.get("representante/listar/",t,function(t){limpar_combobox(a.cbo_representante),$(t).each(function(e,t){var i=[];i.Nome=t.nome_fantasia,add_option_combobox(a.cbo_representante,e,t.representante_id,i)}),a.cbo_representante.parent().find(".ul_row").click(function(){var e=$(this).parent().attr("id_registro");a.representante_id=e,a.salvar_representante()}),e(!0)})},this.listar_funil_vendas_meta=function(){var e=a.tab_funil_vendas.find("tbody"),t=e.find("tr:first");a.tab_funil_vendas.find("tr:gt(1)").remove(),$(a.arr_funil_vendas).each(function(i,n){!function(i,n){var s=t.clone();s.removeAttr("template-row"),s.css("display",""),$(s.find("[template-field='funil_vendas_nome']")).text(n.nome_funil);var r=$(s.find(".btn_deletar"));r.unbind("click"),r.click(function(){var e={meta_id:a.metas_vendas_id,funil_vendas_id:n.funil_vendas_id};WS.post("metas_vendas/excluir_funil_vendas",e,function(e){a.arr_funil_vendas.splice(i,1),a.listar_funil_vendas_meta()},[a.btn_salvar,a.btn_cancelar])}),s.appendTo(e)}(i,n)})},this.listar_representantes_meta=function(){var e=a.tab_representante.find("tbody"),t=e.find("tr:first");a.tab_representante.find("tr:gt(1)").remove(),$(a.arr_representantes).each(function(i,n){!function(i,n){var s=t.clone();s.removeAttr("template-row"),s.css("display",""),$(s.find("[template-field='representante_nome']")).text(n.nome_representante);var r=$(s.find(".btn_deletar"));r.unbind("click"),r.click(function(){var e={meta_id:a.metas_vendas_id,representante_id:n.representante_id};WS.post("metas_vendas/excluir_representante",e,function(e){a.arr_representantes.splice(i,1),a.listar_representantes_meta()},[a.btn_salvar,a.btn_cancelar])}),s.appendTo(e)}(i,n)})},this.salvar_funil_vendas=function(){var e=function(){if(a.funil_vendas_id>0){var e={meta_id:a.metas_vendas_id,funil_vendas_id:a.funil_vendas_id};WS.post("metas_vendas/salvar_funil_vendas",e,function(e){a.arr_funil_vendas=e.arr_funil_vendas,a.listar_funil_vendas_meta()},[a.btn_salvar,a.btn_cancelar]),set_value_combobox(a.cbo_funil,"","")}};a.metas_vendas_id>0?e():a.salvar_meta(e)},this.salvar_representante=function(){var e=function(){if(a.representante_id>0){var e={meta_id:a.metas_vendas_id,representante_id:a.representante_id};WS.post("metas_vendas/salvar_representante",e,function(e){a.arr_representantes=e.arr_representantes,a.listar_representantes_meta()},[a.btn_salvar,a.btn_cancelar]),set_value_combobox(a.cbo_representante,"","")}};a.metas_vendas_id>0?e():a.salvar_meta(e)},this.salvar_meta=function(e){var t={metas_vendas_id:a.metas_vendas_id,descricao:a.edt_descricao.val(),inicio:get_datepicker(a.edt_ini),fim:get_datepicker(a.edt_fim),valor:a.edt_valor.maskMoney("unmasked")[0],tipo:a.cbo_tipo.val(),meta_eventos:CircularJSON.stringify(a.gridEventosRef.current._instance.getController("editing").getChanges())};WS.post("metas_vendas/salvar",t,function(t){a.metas_vendas_id=t.id,alert_saved("Operação realizada com sucesso!"),e?e():a.unload()},[a.btn_salvar,a.btn_cancelar])},this.tipo_meta=function(e){a.div_funil_vendas.addClass("hidden"),a.div_representantes.addClass("hidden"),a.dx_grid.addClass("hidden"),a.edt_valor.prop("disabled",!0),"F"==e?(a.div_funil_vendas.removeClass("hidden"),a.edt_valor.prop("disabled",!1)):"R"==e?(a.div_representantes.removeClass("hidden"),a.edt_valor.prop("disabled",!1)):"E"==e&&a.dx_grid.removeClass("hidden")},this.getDataGridRef=function(e){a.gridEventosRef=e},this.render_grid_metas_eventos=function(){t.render(e.createElement(window.components.MetasEventoCRM.default,{meta_id:a.metas_vendas_id,getDataGridRef:a.getDataGridRef}),a.dx_grid[0])},this.cbo_tipo.unbind("change"),this.cbo_tipo.change(function(){a.tipo_meta(a.cbo_tipo.val())}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(){a.salvar_meta()}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){a.unload()}),this.btn_excluir.unbind("click"),this.btn_excluir.click(function(){var e={metas_vendas_id:a.metas_vendas_id};WS.post("metas_vendas/excluir",e,function(e){alert_saved(e.descricao+" excluído com sucesso"),a.unload()})})}});