define([],function(){return function(e){"use strict";var a=this;this.usuario_id=null,this.nome_usuario=null,this.tipo_usuario=null,this.email=null,this.username=null,this.html_id=e,this.dialog=$("#"+this.html_id),this.title="Opções do Usuário",this.carrega_img=this.dialog.find(".carrega_img"),this.btn_nova_senha=this.dialog.find(".btn_nova_senha"),this.btn_nova_img=this.dialog.find(".btn_nova_img"),this.btn_remover_img=this.dialog.find(".btn_remover_img"),this.btn_alterar_telefone=this.dialog.find(".btn_alterar_telefone"),this.btn_assinatura=this.dialog.find(".btn_assinatura"),this.dx_select_tema=this.dialog.find(".dx_select_tema"),this.files=new Array,this.tema_utilizado=null,this.listar=function(){$("#nome").text(App.sessao.dados.nome),$("#username").text(App.sessao.dados.username),$("#email").text(App.sessao.dados.email),a.carrega_foto(),a.carregar_dados(),a.tema_utilizado=App.get_parametro_usuario("tema_utilizado");a.dx_select_tema.dxSelectBox({dataSource:new DevExpress.data.DataSource.default({store:[{ID:"generic.light",descricao:"Tema padrão claro",categoria:"Temas Claros",url_img:"assets/img/devextreme/temas/light.svg"},{ID:"generic.dark",descricao:"Tema padrão escuro",categoria:"Temas Escuros",url_img:"assets/img/devextreme/temas/dark.svg"},{ID:"material.blue.light",descricao:"Tema material claro",categoria:"Temas Claros",url_img:"assets/img/devextreme/temas/material.blue.light.svg"},{ID:"material.blue.dark",descricao:"Tema material escuro",categoria:"Temas Escuros",url_img:"assets/img/devextreme/temas/material.blue.dark.svg"},{ID:"generic.light.compact",descricao:"Tema padrão claro compacto",categoria:"Temas Claros",url_img:"assets/img/devextreme/temas/light.compact.svg"},{ID:"generic.dark.compact",descricao:"Tema padrão escuro compacto",categoria:"Temas Escuros",url_img:"assets/img/devextreme/temas/dark.compact.svg"},{ID:"material.blue.light.compact",descricao:"Tema material claro compacto",categoria:"Temas Claros",url_img:"assets/img/devextreme/temas/material.blue.light.compact.svg"},{ID:"material.blue.dark.compact",descricao:"Tema material escuro compacto",categoria:"Temas Escuros",url_img:"assets/img/devextreme/temas/material.blue.dark.compact.svg"}],group:"categoria"}),grouped:!0,displayExpr:"descricao",valueExpr:"ID",value:a.tema_utilizado.nome?a.tema_utilizado.nome:"generic.light",onValueChanged:function(e){alert_modal("Atenção !","Esta ação requer que o sistema seja recarregado, deseja continuar ?","Recarregar o sistema",function(){App.set_parametro_usuario("tema_utilizado",{nome:e.value}),DevExpress.ui.themes.current(e.value),"generic.dark"!=e.value&&"material.blue.dark"!=e.value?$(document.body).css("background-color","#ddd"):$(document.body).css("background-color","#2e2e2e"),window.location.reload()},!0)},fieldTemplate:function(e,a){var i=$("<div class='custom-item'><img src='"+e.url_img+"' /><div class='item-descricao'></div></div>");i.find(".item-descricao").dxTextBox({value:e.descricao,readOnly:!0}),a.append(i)},itemTemplate:function(e){return"<div class='custom-item'><img src='"+e.url_img+"' /><div class='item-descricao'>"+e.descricao+"</div></div>"},onOpened:function(e){e.component._popup.option("resizeEnabled",!0)}})},this.carrega_foto=function(e){a.carrega_img.css("width","90px"),e?a.carrega_img.attr("src",WS_URI+"documento/midia_imagens_menores/?documento_id="+e+"&tamanho=90&token_midia="+App.sessao.token_midia+"&considera_excluido=S&anticache="+(new Date).getTime()).on("error",function(){a.carrega_img.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg")}):a.carrega_img.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg")},this.carregar_dados=function(){var e=$("#telefone1"),i=$("#telefone2"),t=$("#telefone3"),o=$("#telefone4"),s=$(".div_telefone1");s.addClass("hidden");var r=$(".div_telefone2");r.addClass("hidden");var n=$(".div_telefone3");n.addClass("hidden");var c=$(".div_telefone4");c.addClass("hidden"),WS.get({route:"usuario/dados_basicos_usuario/",data:{},func_response:function(d){d&&(d.telefone1&&(s.removeClass("hidden"),e.text(d.telefone1)),d.telefone2&&(r.removeClass("hidden"),i.text(d.telefone2)),d.telefone3&&(n.removeClass("hidden"),t.text(d.telefone3)),d.telefone4&&(c.removeClass("hidden"),o.text(d.telefone4)),a.carrega_foto(d.usuario_foto_id))}})},this.btn_nova_img.unbind("click").click(function(){View.load("opcoes_usuario/alterar_foto",function(e,i){i.onclose=a.listar,i.show(FORMULARIO.NOVO)})}),this.btn_remover_img.unbind("click").click(function(){View.load("opcoes_usuario/remover_foto",function(e,i){i.onsave=function(){a.carrega_img.attr("src","assets/img/icones_bp/imagem_usuario_padrao.svg")},i.show(FORMULARIO.NOVO)})}),this.btn_nova_senha.unbind("click").click(function(){View.load("opcoes_usuario/senha",function(e,i){i.onclose=a.listar,i.show(FORMULARIO.NOVO)})}),this.btn_alterar_telefone.unbind("click").click(function(){View.load("opcoes_usuario/alterar_telefone",function(e,i){i.onclose=a.carregar_dados,i.show(FORMULARIO.NOVO)})}),this.btn_assinatura.unbind("click").click(function(){View.load("opcoes_usuario/assinatura",function(e,a){a.show()})}),this.unload=function(){View.unload(this.html_id)},this.listar()}});