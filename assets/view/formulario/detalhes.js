define(["./util"],function(e){return function(o){"use strict";var r=this;this.html_id=o,this.dialog=$("#"+this.html_id),this.title="Formulário",this.tipo=null,this.onclose=null,this.scrollview=this.dialog.find(".scrollview"),this.lbl_titulo_id=this.dialog.find(".lbl_titulo_id"),this.lbl_tab_modelagem=this.dialog.find(".lbl_tab_modelagem"),this.lbl_tab_eventos=this.dialog.find(".lbl_tab_eventos"),this.lbl_tab_configuracoes=this.dialog.find(".lbl_tab_configuracoes"),this.tab_modelagem=this.dialog.find(".tab_modelagem"),this.tab_eventos=this.dialog.find(".tab_eventos"),this.tab_configuracoes=this.dialog.find(".tab_configuracoes"),this.edt_nome=this.dialog.find(".edt_nome"),this.template_grupo=this.dialog.find("[template-grupo]"),this.form_editor=this.dialog.find(".form-editor"),this.form_grupos=this.dialog.find(".form-grupos"),this.template_campo=this.dialog.find("[template-campo]"),this.edt_iniciar=this.dialog.find(".edt_iniciar"),this.btn_form_add_grupo=this.dialog.find(".btn_form_add_grupo"),this.template_elemento=this.dialog.find('[template-field="elemento"]'),this.div_elementos=this.dialog.find(".div_elementos"),this.btn_previsao=this.dialog.find(".btn_previsao"),this.btn_variaveis_template=this.dialog.find(".btn_variaveis_template"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_salvar=this.dialog.find(".btn_salvar"),this.btn_excluir=this.dialog.find(".btn_excluir"),this.btn_fullscreen=this.dialog.find(".btn_fullscreen"),this.chk_imprimir_logo=this.dialog.find(".chk_imprimir_logo"),this.chk_imprimir_dados_empresa=this.dialog.find(".chk_imprimir_dados_empresa"),this.cbo_imprimir_layout_pdf=this.dialog.find(".cbo_imprimir_layout_pdf"),this.chk_formulario_processo=this.dialog.find(".chk_formulario_processo"),this.chk_formulario_cliente=this.dialog.find(".chk_formulario_cliente"),this.formulario_id=null,this.arr_grupos=[],this.tipo_formulario=null,this.editor=null,this.evento_iniciar_construtor=null,this.campo_copiado=null,this.campos_opcoes_menu=[{text:"Detalhes",acao:"detalhes"},{text:"Mover",items:[{text:"Esquerda",acao:"btn_form_up_campo"},{text:"Direira",acao:"btn_form_down_campo"},{text:"Grupo",items:[]},{text:"Antes de",items:[]},{text:"Depois de",items:[]}]},{text:"Copiar",acao:"btn_copiar_campo"},{text:"Remover",acao:"campo_onremove"}],this.show=function(e,o){switch(r.scrollview.dxScrollView().dxScrollView("instance"),r.scrollview.css("height","calc(100vh - 80px)"),r.tab_modelagem.attr("id","tab_modelagem_"+r.html_id),r.tab_eventos.attr("id","tab_eventos_"+r.html_id),r.tab_configuracoes.attr("id","tab_configuracoes_"+r.html_id),r.lbl_tab_modelagem.attr("href","#"+r.tab_modelagem.attr("id")),r.lbl_tab_eventos.attr("href","#"+r.tab_eventos.attr("id")),r.lbl_tab_configuracoes.attr("href","#"+r.tab_configuracoes.attr("id")),o){case FORMULARIO.NOVO:case FORMULARIO.EDITAR:r.btn_salvar.show(),r.btn_excluir.hide();break;case FORMULARIO.VISUALIZAR:r.btn_salvar.hide(),r.btn_excluir.hide();break;case FORMULARIO.EXCLUIR:r.btn_salvar.hide(),r.btn_excluir.show()}r.editor=monta_editor(r.edt_iniciar,"javascript"),r.tipo=o,void 0!==e&&e&&(r.formulario_id=e,r.preencher()),r.permite_alterar(),set_focus(r.edt_nome)},this.close=function(){void 0!==r.onclose&&r.onclose&&r.onclose()},this.unload=function(){r.close(),View.unload(this.html_id)},this.permite_alterar=function(){var e=!1;switch(r.tipo){case FORMULARIO.NOVO:case FORMULARIO.EDITAR:e=!0;break;case FORMULARIO.VISUALIZAR:case FORMULARIO.EXCLUIR:e=!1}r.edt_nome.prop("readonly",!e),r.edt_iniciar.prop("disabled",!e),e||(r.form_editor.find("button").attr("disabled",!0),r.form_editor.find("input").attr("readonly",!0))},this.listar_elementos=function(){r.div_elementos.find("br").remove(),r.div_elementos.find("span").remove();var e=function(e){if(!e.id_elemento)return!1;var o=r.template_elemento.clone();o.css("display",""),o.text(e.id_elemento),o.appendTo(r.div_elementos),$("<br>").appendTo(r.div_elementos)};e({id_elemento:"obj_solicitacao"}),$(r.arr_grupos).each(function(o,r){$(r.elementos).each(function(o,r){r.tipo==ELEMENTO_TIPO.TABELA?(null!=r.id_elemento&&e(r),$(r.campos).each(function(o,r){null!=r.id_elemento&&e(r)})):null!=r.id_elemento&&e(r)})})},this.preencher=function(o){r.title="Formulário #"+r.formulario_id,App.titulo_aba(r.html_id,r.title);var i=function(o){r.lbl_titulo_id.text("Id."+o.id),r.edt_nome.val(o.nome),r.editor.getDoc().setValue(o.evento_iniciar),r.arr_grupos=o.grupos,r.evento_iniciar_construtor=o.evento_iniciar_construtor?JSON.parse(o.evento_iniciar_construtor):{};const i=new e;r.evento_iniciar_construtor=i.reprocessar_evento_alterar_iniciar({obj_formulario:{grupos:r.arr_grupos,evento_iniciar_construtor:r.evento_iniciar_construtor}});for(var t=0;t<r.arr_grupos.length;t++){void 0!==r.arr_grupos[t].elementos&&r.arr_grupos[t].elementos||(r.arr_grupos[t].elementos=[]);var a=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random()));r.arr_grupos[t].elem_key=a,r.arr_grupos[t].removido=!1}r.chk_imprimir_logo.prop("checked",o.imprimir_logo_empresa).trigger("change"),r.chk_imprimir_dados_empresa.prop("checked",o.imprimir_dados_empresa).trigger("change"),r.cbo_imprimir_layout_pdf.val(o.imprimir_layout_pdf),0==o.tipo_formulario?(r.chk_formulario_processo.prop("checked",!0).trigger("change"),r.chk_formulario_cliente.prop("checked",!1).trigger("change")):(r.chk_formulario_processo.prop("checked",!1).trigger("change"),r.chk_formulario_cliente.prop("checked",!0).trigger("change")),r.render_editor(null,!0),r.listar_elementos()};o?i(o):WS.get("formulario/objeto/",{formulario_id:r.formulario_id},i)},this.processar_campo_menu_contexto=function(){r.campos_opcoes_menu[1].items[2].items=[];var e=r.arr_grupos.filter(e=>!0!==e.removido);$(e).each(function(e,o){r.campos_opcoes_menu[1].items[2].items.push({text:o.nome,acao:"btn_mover_grupo",formulario_grupo_elem_key:o.elem_key})})},this.render_editor=function(e,o,i){r.form_grupos.html("");var t=null,a=null,n=r.arr_grupos.filter(e=>!0!==e.removido);n=n.sort(function(e,o){return pad(e.sequencia,10)>pad(o.sequencia,10)?1:pad(e.sequencia,10)<pad(o.sequencia,10)?-1:0}),$(n).each(function(n,l){var _=r.template_grupo.clone();_.css("display",""),_.attr("elem-key",l.elem_key);var s=_.find(".edt_grupo_sequencia");s.val(l.sequencia),s.unbind("change"),s.change(function(){for(var e=0;e<r.arr_grupos.length;e++)r.arr_grupos[e].elem_key==l.elem_key&&(isNaN(s.val())||(r.arr_grupos[e].sequencia=parseInt(s.val()),r.render_editor(l.elem_key)))});var c=_.find(".edt_grupo_nome");c.val(l.nome),c.unbind("change"),c.change(function(){for(var e=0;e<r.arr_grupos.length;e++)r.arr_grupos[e].elem_key==l.elem_key&&(r.arr_grupos[e].nome=c.val(),r.processar_campo_menu_contexto())}),void 0!==e&&l.elem_key==e&&(t=c);var m=_.find(".btn_form_up_grupo");m.unbind("click"),m.click(function(){for(var e=r.arr_grupos.filter(e=>!0!==e.removido),o=-1,i=0;i<e.length;i++)e[i].elem_key==l.elem_key&&(o=i);if(o>0){var t=e[o-1].elem_key,a=-1;for(i=0;i<r.arr_grupos.length;i++)r.arr_grupos[i].elem_key==l.elem_key?o=i:r.arr_grupos[i].elem_key==t&&(a=i);var n=r.arr_grupos[o],_=r.arr_grupos[a],s=n.sequencia,c=_.sequencia;n.sequencia=c,_.sequencia=s,r.arr_grupos[a]=n,r.arr_grupos[o]=_,r.render_editor(n.elem_key)}});var d=_.find(".btn_form_down_grupo");d.unbind("click"),d.click(function(){for(var e=r.arr_grupos.filter(e=>!0!==e.removido),o=-1,i=0;i<e.length;i++)e[i].elem_key==l.elem_key&&(o=i);if(o<e.length-1){var t=e[o+1].elem_key,a=-1;for(i=0;i<r.arr_grupos.length;i++)r.arr_grupos[i].elem_key==l.elem_key?o=i:r.arr_grupos[i].elem_key==t&&(a=i);var n=r.arr_grupos[o],_=r.arr_grupos[a],s=n.sequencia,c=_.sequencia;n.sequencia=c,_.sequencia=s,r.arr_grupos[a]=n,r.arr_grupos[o]=_,r.render_editor(n.elem_key)}});var u=_.find(".btn_form_rem_grupo");u.unbind("click"),u.click(function(){alert_modal("Validação",'Deseja remover o grupo "'+l.nome+'" ?',"Remover",function(){for(var e=null,o=0;o<r.arr_grupos.length;o++)r.arr_grupos[o].elem_key==l.elem_key&&(e=o);for(o=e+1;o<r.arr_grupos.length;o++)r.arr_grupos[o].sequencia=r.arr_grupos[o].sequencia-1;r.arr_grupos[e].removido=!0,r.render_editor()},!0)});var p=function(e,o){r.evento_iniciar_construtor=o;for(var i=-1,t=0;t<r.arr_grupos.length;t++)r.arr_grupos[t].elem_key==l.elem_key&&(i=t);if(void 0!==r.arr_grupos[i].elementos&&r.arr_grupos[i].elementos){var a=-1,n=r.arr_grupos[i].elementos;for(t=0;t<n.length;t++)n[t].elem_key==e.elem_key&&(a=t);a<0?r.arr_grupos[i].elementos.push(e):r.arr_grupos[i].elementos[a]=e}r.render_editor(r.arr_grupos[i].elem_key,!1,e.elem_key)},f=function(e){for(var o=-1,i=0;i<r.arr_grupos.length;i++)r.arr_grupos[i].elem_key==l.elem_key&&(o=i);if(void 0!==r.arr_grupos[o].elementos&&r.arr_grupos[o].elementos){var t=-1,a=r.arr_grupos[o].elementos;for(i=0;i<a.length;i++)a[i].elem_key==e.elem_key&&(t=i);t>=0&&r.arr_grupos[o].elementos.splice(t,1)}r.render_editor(r.arr_grupos[o].elem_key,!1)},h=_.find(".btn_form_add_campo");h.unbind("click"),h.click(function(){r.tipo_formulario=r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null,View.load("formulario/campo",function(e,o){o.onsave=p,o.show(null,FORMULARIO.NOVO,!1,null,r.arr_grupos,r.evento_iniciar_construtor)})});var g=_.find(".btn_form_add_tabela");g.unbind("click"),g.click(function(){r.tipo_formulario=r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null,View.load("formulario/tabela",function(e,o){o.onsave=p,o.show(null,FORMULARIO.NOVO,r.arr_grupos,r.tipo_formulario,r.evento_iniciar_construtor)})});var v=_.find(".btn_colar_campo");v.unbind("click"),v.click(function(){if(!r.campo_copiado)return!1;let e=JSON.parse(JSON.stringify(r.campo_copiado));e.elem_key=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random())),e.id_elemento="",e.tipo==ELEMENTO_TIPO.TABELA&&e.campos.length>0&&e.campos.forEach((o,r)=>{e.campos[r].elem_key=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random())),e.campos[r].id_elemento=""}),l.elementos.push(e),r.render_editor(l.elem_key,!1,e.elem_key)}),void 0!==l.elementos&&l.elementos&&$(l.elementos).each(function(e,o){var n=r.template_campo.clone();n.css("display",""),n.attr("elem-key",o.elem_key),n.addClass("col-sm-"+o.colunas);var s=n.find(".lbl_nome"),c=(n.find(".input_foco"),n.find(".lbl_tipo")),m=n.find(".div_tabela_campos"),d=n.find(".lbl_id"),u=n.find(".lbl_obrigatorio"),h=n.find(".lbl_possui_evento");s.html(nl2br(o.nome));var g=str_elemento_tipo_completo(o);if(c.text(g),o.id_elemento?d.text("ID: "+o.id_elemento):(d.text("Informe o ID"),d.toggleClass("label-default label-danger")),o.tipo==ELEMENTO_TIPO.TABELA&&o.campos.length>0){let e='<table style="width: 100%">';$(o.campos).each(function(o,r){e+="<tr>",e+='<td class="small text-muted">'+r.nome+"</td>",e+="<td>",e+='<span class="lbl_tipo label label-default">'+str_elemento_tipo_completo(r)+"</span>&nbsp;",r.id_elemento?e+='<span class="lbl_id label label-default">ID: '+r.id_elemento+"</span>&nbsp;":e+='<span class="lbl_id label label-danger">Informe o ID</span>&nbsp;',r.obrigatorio&&"true"===r.obrigatorio.toString()&&(e+='<span class="lbl_obrigatorio label label-warning">obrigatorio</span>&nbsp;'),(r.evento_alterar&&r.evento_alterar.trim()||r.evento_clicar&&r.evento_clicar.trim()||r.evento_limpar&&r.evento_limpar.trim()||r.evento_selecionar&&r.evento_selecionar.trim())&&(e+='<span class="lbl_possui_evento label label-info" title="Possui eventos javascript"><i class="fas fa-code"></i></span>'),e+="</tr>"}),e+="</table>",m.html(e),m.show()}u.hide(),o.obrigatorio&&"true"===o.obrigatorio.toString()&&u.show(),h.hide(),(o.evento_alterar&&o.evento_alterar.trim()||o.evento_clicar&&o.evento_clicar.trim()||o.evento_limpar&&o.evento_limpar.trim()||o.evento_selecionar&&o.evento_selecionar.trim())&&h.show();let b=n.find(".div_campo");b.unbind("click"),b.click(function(){var e=FORMULARIO.VISUALIZAR;r.tipo!=FORMULARIO.NOVO&&r.tipo!=FORMULARIO.EDITAR||(e=FORMULARIO.EDITAR),o.tipo==ELEMENTO_TIPO.TABELA?View.load("formulario/tabela",function(i,t){r.tipo_formulario=r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null,t.onsave=p,t.onremove=f,t.show(o,e,r.arr_grupos,r.tipo_formulario,r.evento_iniciar_construtor)}):View.load("formulario/campo",function(i,t){r.tipo_formulario=r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null,t.onsave=p,t.onremove=f,t.show(o,e,!1,null,r.arr_grupos,r.evento_iniciar_construtor)})});var k=n.find(".btn_form_up_campo");k.unbind("click"),k.click(function(){var e=-1;if($(l.elementos).each(function(r,i){i==o&&(e=r)}),e>0){var r=e-1,i=l.elementos[e],t=l.elementos[r];l.elementos[r]=i,l.elementos[e]=t,$(n).prev().before(n)}});var y=n.find(".btn_form_down_campo");y.unbind("click"),y.click(function(){var e=-1;if($(l.elementos).each(function(r,i){i==o&&(e=r)}),e+1<l.elementos.length){var r=e+1,i=l.elementos[e],t=l.elementos[r];l.elementos[r]=i,l.elementos[e]=t,$(n).next().after(n)}}),n.find(".context-menu").dxContextMenu({dataSource:r.campos_opcoes_menu,onPositioning(e){let o=r.arr_grupos.filter(o=>o.elem_key==$(e.position.of.currentTarget).closest("[template-grupo]").attr("elem-key")),i=$(e.position.of.currentTarget).parent().attr("elem-key"),t=null;if(o.length){o=o[0];let e=[];if(o.elementos&&o.elementos.length){for(let r=0;r<o.elementos.length;r++){let a=o.elementos[r];a.elem_key!=i?e.push(a):t=a}r.campos_opcoes_menu[1].items[3].items=[],r.campos_opcoes_menu[1].items[4].items=[];for(let o=0;o<e.length;o++){let i=e[o];r.campos_opcoes_menu[1].items[3].items.push({text:i.nome,acao:"mover_antes_de_campo",elemento_selecionado:i,elemento_atual:t}),r.campos_opcoes_menu[1].items[4].items.push({text:i.nome,acao:"mover_depois_de_campo",elemento_selecionado:i,elemento_atual:t})}}}e.component.option("dataSource",r.campos_opcoes_menu)},target:b,onItemClick(e){const i=(o=null)=>{let r=-1;if($(l.elementos).each(function(o,i){i.elem_key==e.itemData.elemento_atual.elem_key&&(r=o)}),r>-1){let i=-1;if($(l.elementos).each(function(o,r){r.elem_key==e.itemData.elemento_selecionado.elem_key&&(i=o)}),i>-1){let e=r-i;if(e>0){"depois"===o&&(i+=1);for(let e=r;e>i;e--)k.trigger("click")}else if(e<0){"antes"===o&&(i-=1);for(let e=r;e<i;e++)y.trigger("click")}}}};if(e.itemData.acao)switch(e.itemData.acao){case"detalhes":b.trigger("click");break;case"btn_form_up_campo":k.trigger("click");break;case"btn_form_down_campo":y.trigger("click");break;case"btn_copiar_campo":r.campo_copiado=Object.assign({},o),r.dialog.find(".btn_colar_campo").removeClass("disabled");break;case"btn_colar_campo":v.trigger("click");break;case"btn_mover_grupo":if(l.elem_key===e.itemData.formulario_grupo_elem_key)break;DevExpress.ui.dialog.confirm("Deseja realmente mover este campo? O vínculo dele com outros campos e gateways deixarão de funcionar.","Mover campo").done(function(i){r.arr_grupos.forEach(t=>{if(i){const i=Object.assign({},o);t.elem_key==e.itemData.formulario_grupo_elem_key&&(t.elementos.push(i),r.render_editor(t.elem_key,!1)),t.elem_key==l.elem_key&&f(o)}})});break;case"campo_onremove":DevExpress.ui.dialog.confirm("Deseja realmente remover este campo? Ele não poderá ser recuperado.","Remover campo").done(function(e){e&&f(o)});break;case"mover_antes_de_campo":i("antes");break;case"mover_depois_de_campo":i("depois")}}}),n.appendTo(_.find(".form-grupos-campos")),i&&i===o.elem_key&&n.find("input").length>0&&(t=n.find("input"),a=()=>{t.hide()})}),_.appendTo(r.form_grupos),r.permite_alterar(),o||(t?(t.show(),set_focus(t,a)):set_focus(c))}),r.processar_campo_menu_contexto()},this.btn_form_add_grupo.unbind("click"),this.btn_form_add_grupo.click(function(){var e=r.arr_grupos.filter(e=>!0!==e.removido);e.sort((e,o)=>e.sequencia-o.sequencia);for(let o=0;o<e.length;o++)e[o].sequencia=o+1;var o=e.length+1,i=String((new Date).getTime())+String(Math.round(1e4*Math.random()))+String((new Date).getTime())+String(Math.round(1e4*Math.random()));r.arr_grupos.push({id:0,elem_key:i,formulario_grupo_id:null,sequencia:o,nome:"",elementos:[],removido:!1}),r.render_editor()}),this.btn_previsao.unbind("click"),this.btn_previsao.click(function(){var e={formulario_id:r.formulario_id,nome:r.edt_nome.val(),grupos:r.arr_grupos,evento_iniciar:r.editor.getValue(),evento_iniciar_construtor:r.evento_iniciar_construtor};View.load("formulario/previsao",function(o,r){r.show(e)},View.ABA.MULTIPLAS)}),this.btn_variaveis_template.unbind("click"),this.btn_variaveis_template.click(function(){let e="";r.arr_grupos.forEach(o=>{o.elementos.forEach(o=>{if(o.id_elemento){if(o.tipo==ELEMENTO_TIPO.TABELA)return e+="\n${form_"+o.id_elemento+"}\n",o.campos.forEach(o=>{e+="${form_"+o.id_elemento+"}\n",o.tipo==ELEMENTO_TIPO.ANEXO&&(e+="${form_img_"+o.id_elemento+"}\n\n")}),void(e+="${/form_"+o.id_elemento+"}\n\n");if(o.tipo==ELEMENTO_TIPO.EDITOR_TEXTO)return e+="\n${form_"+o.id_elemento+"}\n",e+="${conteudo_form_"+o.id_elemento+"}\n",void(e+="${/form_"+o.id_elemento+"}\n\n");e+="${form_"+o.id_elemento+"}\n\n",o.tipo==ELEMENTO_TIPO.ANEXO&&(e+="${form_img_"+o.id_elemento+"}\n\n")}})}),alertaPopUp("Variáveis de Template",$('<textarea class="form-control" rows="20" style="min-width: 800px" disabled="true">').val(e)[0])}),this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){r.unload()}),this.btn_salvar.unbind("click"),this.btn_salvar.click(function(e){if(null!=(r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null)){var o=!1;e:for(var i=0;i<r.arr_grupos.length;i++)for(var t=r.arr_grupos[i],a=0;a<t.elementos.length;a++){var n=t.elementos[a];if(!n.id_elemento){o=!0;break e}if(n.tipo==ELEMENTO_TIPO.TABELA)for(var l=0;l<n.campos.length;l++){if(!n.campos[l].id_elemento){o=!0;break e}}}var _=function(){WS.post("formulario/salvar",{formulario_id:r.formulario_id,nome:r.edt_nome.val(),grupos:JSON.stringify(r.arr_grupos),evento_iniciar:JSON.stringify(r.editor.getValue()),evento_iniciar_construtor:JSON.stringify(r.evento_iniciar_construtor),imprimir_logo_empresa:r.chk_imprimir_logo.prop("checked"),imprimir_dados_empresa:r.chk_imprimir_dados_empresa.prop("checked"),imprimir_layout_pdf:r.cbo_imprimir_layout_pdf.val(),tipo_formulario:r.chk_formulario_processo.prop("checked")?0:r.chk_formulario_cliente.prop("checked")?1:null},function(o){r.formulario_id=o.id,r.tipo=FORMULARIO.EDITAR,alert_saved(o.nome+" salvo com sucesso"),e.currentTarget.classList.contains("salvar-e-sair")?r.unload():r.preencher(o)},[r.btn_salvar])};o?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !',"Existem campos no formulário que não possuem ID, deseja gerar id automaticamente ? <br />Não é possível mudar o ID de um campo.",'<i class="fa fa-check" aria-hidden="true"></i> Sim, Gerar IDs',function(){!function(){for(var e=1,o=1,i=1,t=0;t<r.arr_grupos.length;t++)for(var a=r.arr_grupos[t],n=0;n<a.elementos.length;n++){var l=a.elementos[n];if(!l.id_elemento)if(l.tipo==ELEMENTO_TIPO.TABELA){l.id_elemento="tabela_"+o,o++;for(var s=0;s<l.campos.length;s++){var c=l.campos[s];c.id_elemento||(c.id_elemento="campo_tabela"+i,i++)}}else l.id_elemento="campo_"+e,e++}_()}()},!0):_()}else alert_modal('<i class="fa fa-check pull-left" aria-hidden="true"></i> Aviso !',"Local de utilização não informado <br /> por gentileza, informe um local de utilização do formulário.")}),this.btn_excluir.unbind("click"),this.btn_excluir.click(function(){WS.post("formulario/excluir",{formulario_id:r.formulario_id},function(e){alert_saved(e.nome+" excluido com sucesso"),r.unload()},[r.btn_excluir])}),this.btn_fullscreen.off("click").on("click",()=>{alert_warning('Para sair do modo "Tela Cheia" pressione a tecla "ESC"'),r.editor.setOption("fullScreen",!r.editor.getOption("fullScreen")),r.editor.focus()}),this.chk_formulario_processo.unbind("change").change(function(e){1==$(this).prop("checked")&&r.chk_formulario_cliente.prop("checked",!1).change()}),this.chk_formulario_cliente.unbind("change").change(function(e){1==$(this).prop("checked")&&r.chk_formulario_processo.prop("checked",!1).change()}),this.lbl_tab_modelagem.off("click").on("click",()=>{r.btn_form_add_grupo.removeClass("hidden")}),this.lbl_tab_eventos.off("click").on("click",()=>{r.btn_form_add_grupo.addClass("hidden")}),this.lbl_tab_configuracoes.off("click").on("click",()=>{r.btn_form_add_grupo.addClass("hidden")})}});