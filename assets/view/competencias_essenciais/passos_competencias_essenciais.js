define([],function(){return function(a){"use strict";var i=this;this.html_id=a,this.dialog=$("#"+this.html_id),this.title="Ações, Metas e resultados (Competências Essenciais)",this.btn_proxima_etapa=this.dialog.find(".btn_proxima_etapa"),this.btn_voltar=this.dialog.find(".btn_voltar"),this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_confirmar=this.dialog.find(".btn_confirmar"),this.btn_fechar=this.dialog.find(".btn_fechar"),this.tabela_habilidades=this.dialog.find(".tabela_habilidades"),this.steps=this.dialog.find(".steps"),this.tabela_possibilidades=this.dialog.find(".tabela_possibilidades"),this.tabela_possibilidades_acao=this.dialog.find(".tabela_possibilidades_acao"),this.tabela_acao_possibilidade=this.dialog.find(".tabela_acao_possibilidade"),this.tabela_acao_possibilidade_a2=this.dialog.find(".tabela_acao_possibilidade_a2"),this.descricao_habilidade_escolhida=this.dialog.find(".descricao_habilidade_escolhida"),this.arr_possibilidades=[],this.arr_possibilidades_acao_24_horas=[],this.tabela_possibilidades_a2=this.dialog.find(".tabela_possibilidades_a2"),this.tabela_possibilidades_acao_a2=this.dialog.find(".tabela_possibilidades_acao_a2"),this.descricao_habilidade_escolhida_a2=this.dialog.find(".descricao_habilidade_escolhida_a2"),this.nome_responsabilidade=this.dialog.find(".nome_responsabilidade"),this.arr_possibilidades_a2=[],this.arr_possibilidades_acao_24_horas_a2=[],this.check_acao=this.dialog.find(".check_acao"),this.check_acao_a2=this.dialog.find(".check_acao_a2"),this.pagina=this.dialog.find(".pagina"),this.media_efetividade=this.dialog.find(".media_efetividade"),this.media_desejado=this.dialog.find(".media_desejado"),this.media_qe=this.dialog.find(".media_qe"),this.btn_info_competencias=this.dialog.find(".btn_info_competencias"),this.btn_info_curva_abc=this.dialog.find(".btn_info_curva_abc"),this.btn_info_brainstorming=this.dialog.find(".btn_info_brainstorming"),this.arr_steps=[],this.indice_atual=0,this.indicador_id=0,this.MODO_EDICAO=!0,this.flag_salvar=!0,this.arr_telas=[],this.atuacao_efetiva_id=0,this.id_habilidade_escolhida=0,this.id_habilidade_escolhida_a2=0,this.competencias_essenciais_id=0,this.arr_acoes_possibilidades=[],this.arr_acoes_possibilidades_a2=[],this.tela_atual=1,this.usuario_id=0,this.responsabilidade_id=0,this.atuacao_efetiva_id=0,this.finalizada=!1,this.show=function(a,e,s,o,t){i.usuario_id=s,i.nome_responsabilidade.text(e),i.competencias_essenciais_id=a,i.preencher_habilidades(a),i.responsabilidade_id=o,i.atuacao_efetiva_id=t,i.carrega_habilidades_a(),i.tabela_possibilidades_acao.find("tbody tr").find(".check_acao").prop("checked",!1).change(),i.tabela_possibilidades_acao_a2.find("tbody tr").find(".check_acao").prop("checked",!1).change(),i.carrega_passos()},this.carrega_passos=function(){WS.get("competencias_essenciais/listar_passo/",{competencias_essenciais_id:i.competencias_essenciais_id},function(a){var e=a[0];e.tela_atual=e.tela_atual||0,i.tela_atual=e.tela_atual,i.finalizada="S"==e.finalizada;for(var s=0;s<=+e.tela_atual;s++)$(i.steps.find("li")[s]).show()})},this.salvar_tela_atual=function(){+i.tela_atual<=i.indice_atual&&WS.post("competencias_essenciais/salvar_tela_atual/",{tela_atual:i.indice_atual,competencias_essenciais_id:i.competencias_essenciais_id},function(a){$(i.steps.find("li")[i.indice_atual]).fadeIn("slow"),i.tela_atual=a.tela_atual})},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){i.unload()}),this.btn_proxima_etapa.unbind("click"),this.btn_proxima_etapa.click(function(){i.flag_salvar=!0,i.indice_atual++,i.salvar_tela_atual(i.indice_atual),i.passos(i.indice_atual)}),this.btn_voltar.unbind("click"),this.btn_voltar.click(function(){i.btn_proxima_etapa.prop("disabled",!1),i.flag_salvar=!1,i.indice_atual--,i.passos(i.indice_atual)}),this.btn_fechar.unbind("click"),this.btn_fechar.click(function(){i.unload()}),this.btn_info_competencias.unbind("click"),this.btn_info_competencias.click(function(a){var i=$('<p><b style="font-size: 25px;">P</b>ensando especificamente na execução das ações e desempenho efetivo nesta Responsabilidade escolhida, quais seriam os conhecimentos que se você adquirisse, poderia melhorar a sua performance, produtividade e execução em termos de tempo (fazer mais rápido), ou qualidade (fazer melhor), eficiência (fazer com um menor custo), volume, em fim. Quais habilidades que se você aprimorasse, poderia melhorar a sua performance, produtividade e execução.  Quais Atitudes ou comportamentos que se você tivesse mais, poderia melhorar a sua performance, produtividade e execução. Não é o que você tem que fazer, mas, o que VOCÊ PRECISA MELHORAR EM VOCÊ (individuo), para que as suas ações sejam melhores executadas. COMPETÊNCIAS! Aquilo que faz com que duas pessoas executem a mesma coisa, porém, um com muito mais performance que outras.  </p><p><b style="font-size: 25px;">E</b>ntendimento: </p><p><b style="font-size: 25px;">I</b>magine que a “área” de responsabilidade em minha matriz de atuação efetiva fosse Planejamento de Visitas a clientes. </p><p><b style="font-size: 25px;">A</b>nteriormente, nós já elaboramos um plano de ação inclusive com “sub-metas” para cada 07 dias.  </p><p><b style="font-size: 25px;">N</b>este momento, o que vamos trabalhar não é o que você vai fazer (isso já foi definido anteriormente), porém, vamos trabalhar as competências que nos permitam “fazer” o que defini que vou fazer, porém com um nível de performance extraordinária e aumente consequentemente minha efetividade.  </p><p><b style="font-size: 25px;">E</b>xemplo de pergunta para entendimento: A Pergunta que temos que fazer neste caso é: Quais competência (Conhecimentos, Habilidades, Atitudes) se eu desenvolver AINDA MAIS (pode ser que eu tenha, porém, necessito melhorar) poderia me ajudar a fazer o que tenho que fazer (especificamente na responsabilidades definida – PLANEJAMENTO DE VISITAS), melhor que qualquer outra pessoa? Conhecimentos tem relação com buscar informação, Habilidade tem a ver com prática e treino e Atitude tem relação com forma de agir, maneira, comportamento. Ou seja, quando não se sabe algo, falta conhecimento. Quando até se sabe (teoria), ou seja, tem o conhecimento, porém, nunca ou pouco tentou-se fazer, subentende que você deva praticar, fazer, fazer até ficar bom e ter domínio sobre aquilo. Porém tem coisa que você sabe fazer, tem domino sobre aquilo, porém, não está fazendo, ou por “preguiça”, ou falta de atenção, ou falta de motivo.  </p><p><b style="font-size: 25px;">E</b>xemplo de competências: NESTE CASO O MEU FOCO (atenção direcionada) É “PLANEJAMENTO DE VISITAS”. (Exemplo de responsabilidade escolhida como de Alto Impacto em um dos meus principais KPIs).  </p><p><b style="font-size: 25px;">C</b>onhecimento mais aprofundado sobre o tema “Planejamento”. (Apenas conhecer mais sobre o tema).  </p><p><b style="font-size: 25px;">C</b>onhecimento mais aprofundado sobre regiões x clientes potenciais. (Conheço, porém acredito que devo conhecer ainda mais). </p><p><b style="font-size: 25px;">M</b>elhorar habilidade de gestão do tempo. (Tenho conhecimento, porém, não estou praticando, e preciso praticar mais, inclusive ter “mais tempo” para dedicar ao planejamento).  </p><p><b style="font-size: 25px;">D</b>evo agir de forma mais disciplinado (comportamento). (Tenho disciplina para várias coisas na minha vida, porém, para fazer planejamento eu não estou conseguindo ser disciplinado.  </p><p><b style="font-size: 25px;">D</b>evo agir de forma mais detalhista e “caprichosa”. (Sou detalhista para várias coisas, porém na hora de fazer o planejamento de visitas, sinto que estou fazendo de maneira mediana, ou seja, eu poderia ser muito mais detalhista e caprichar mais, tendo em vista que neste momento é uma atividade de alavanca no meio KPI).  </p><p><b style="font-size: 25px;">O</b> número de “competências” e relevante. Também, se necessário, por um questão de prioridade, pode surgir mais atitudes na lista, ou mais habilidades ou conhecimentos. Isso também é relevante.  </p><p><b style="font-size: 25px;">F</b>aça uma boa reflexão e acreditamos que este ponto será fundamental e a chave para seu sucesso, por isso, se esforce e verá a recompensa.  </p><p><b style="font-size: 25px;">B</b>om trabalho! </p>');View.load("atuacao_efetiva/tutorial",function(a,e){e.show(i,"Competências Essenciais")},View.ABA.NAO)}),this.btn_info_curva_abc.unbind("click"),this.btn_info_curva_abc.click(function(a){var i=$('<p><b style="font-size: 25px;">D</b>entre as competências selecionadas, faremos novamente uma curva ABC, porém, você poderá selecionar apenas duas como A de Alto Impacto, </p> <p>que neste momento você credita ser a mais estratégica, relevante e impactante na execução das suas ações já definidas para responsabilidade escolhida. Bs (médio impacto) </p> <p>e Cs (baixo impacto), à vontade.  </p> ');View.load("atuacao_efetiva/tutorial",function(a,e){e.show(i,"Competências Essenciais")},View.ABA.NAO)}),this.btn_info_brainstorming.unbind("click"),this.btn_info_brainstorming.click(function(a){var i=$('<p><b style="font-size: 25px;">P</b>ara o desenvolvimento de competências, temos três linhas especificas a seguir: </p> <p><b style="font-size: 25px;">1</b>. Conhecimento: Significa Ato ou efeito de conhecer; notícia; informação; instrução; estudo. </p> <p><b style="font-size: 25px;">P</b>ara aprimorar o conhecimento, podemos fazê-lo de forma formal ou informal.  </p> <p><b style="font-size: 25px;">F</b>ormal: Cursos, faculdade, MBAs etc. </p> <p><b style="font-size: 25px;">I</b>nformação: Observação e vivencias.  </p> <p><b style="font-size: 25px;">C</b>om base nisso, ao querer montar um plano de ação para desenvolver conhecimento, pode constar neste plano, leituras, vídeos (hoje a internet possui um imensidão de informações e vídeos que devem ser evidentemente filtrados, porém, se encontra quase tudo), aulas em áudio, cursos formais e troca de experiência com outras pessoas, coisas como “pequenos estágios”. </p> <p><b style="font-size: 25px;">1</b>. Habilidades: Significa Aptidão para algo; destreza; astúcia; adquirido através de treinamento. </p> <p><b style="font-size: 25px;">P</b>ara aprimorar nossas habilidades, quero lembrar de frase bem popular que diz: “A prática, leva a perfeição”. Pois é, para desenvolver habilidades, nada melhor do que práticas. Porem como nem sempre temos oportunidade de praticar ou não podemos “arriscar”, a melhor forma para se desenvolver é a simulação, pois é o que mais se aproxima da realidade. Então ter uma boa base de conhecimento é importante, porém praticar este conhecimento é ainda mais importante. </p> <p><b style="font-size: 25px;">C</b>om base nisso, ao querer montar um plano de ação para desenvolver habilidades, pode constar neste plano, participar de treinamentos práticos (certificar-se que haverá praticas “reais” ou melhor, praticas que simulem a realidade, treinos sozinho, treino com colegas ou até mesmo contratar um Coach com foco em desenvolvimento de habilidades.  </p> <p><b style="font-size: 25px;">3</b>. Atitudes: Significa o Modo de proceder ou agir; maneira; comportamento; procedimento. </p> <p><b style="font-size: 25px;">P</b>ara modelar atitudes é necessário compreender qual é o comportamento “negativo” e qual deveria ser o comportamento ideal que o substituiria, Como, quando, onde, com quem e por que? Uma Vez feito isso, definiremos uma estratégia que me permita lembrar ou ser avisado com relação ao seu comportamento ideal. Algumas pessoas costumam utilizar-se de lembretes em seu celular, trocar o relógio de braço ou até mesmo utilizar um elástico de dinheiro no punho, tudo para lembrar e trazer para o nível da consciência o comportamento ideal. Caso contrário, muitos comportamentos serão os reflexos sem filtros dos sentimentos e emoções momentâneas.  </p> <p><b style="font-size: 25px;">B</b>om trabalho! </p> ');View.load("atuacao_efetiva/tutorial",function(a,e){e.show(i,"Competências Essenciais")},View.ABA.NAO)}),this.btn_confirmar.unbind("click"),this.btn_confirmar.click(function(){var a=i.tabela_acao_possibilidade_a2.find("tbody tr");$.each(a,function(a,e){$.each(i.arr_acoes_possibilidades_a2,function(a,s){s.id==$(e).find("td").attr("data-id")&&""!=$(e).find("td textarea").val()&&(i.arr_acoes_possibilidades_a2[a].meta_acao_24_horas=$(e).find("td textarea").val())})}),i.salva_possibilidade_acao(i.arr_acoes_possibilidades_a2,i.id_habilidade_escolhida_a2,"a2"),i.finalizada?i.unload():(View.load("competencias_essenciais/fechamento",function(a,e){e.show(i.competencias_essenciais_id,i.responsabilidade_id,i.atuacao_efetiva_id);e.onclose=function(a){a&&i.unload()}}),i.finaliza_competencia_essencial())}),this.check_acao.click(function(a){var e=$(this),s=e.closest("tr").attr("data-id"),o=1==(o=!e.find("[type='checkbox']").prop("checked"))?"S":"N";s&&1==i.MODO_EDICAO&&i.salva_possibilidade_acao_24_horas([{acao_vinte_quatro_horas:o,id:s}],i.id_habilidade_escolhida,"a1")}),this.check_acao_a2.click(function(a){var e=$(this),s=e.closest("tr").attr("data-id"),o=1==(o=!e.find("[type='checkbox']").prop("checked"))?"S":"N";s&&1==i.MODO_EDICAO&&i.salva_possibilidade_acao_24_horas([{acao_vinte_quatro_horas:o,id:s}],i.id_habilidade_escolhida_a2,"a2")}),this.finaliza_competencia_essencial=function(){WS.post("competencias_essenciais/salvar/",{competencias_essenciais_id:i.competencias_essenciais_id,finalizada:"S"},function(a){alert_saved("Salvo com sucesso"),i.finalizada=!0,void 0!==i.onsave&&i.onsave&&i.onsave(a)})},this.voltar_ao_topo=function(){$("html, body").animate({scrollTop:0},200,"linear")},this.salva_possibilidade_acao=function(a,e,s){WS.post("competencias_essenciais_acao/salvar/",{possibilidades:JSON.stringify(a),id_habilidade_escolhida:e,competencias_essenciais_id:i.competencias_essenciais_id,usuario_id:i.usuario_id},function(a){var o=a[0];i.preencher_possibilidades(o,s),i.preencher_acao_possibilidades(o,s),i.atualiza_possibilidades_acao_24_horas(e,s),alert_saved("Salvo com sucesso"),void 0!==i.onsave&&i.onsave&&i.onsave(a)})},this.preencher_possibilidades=function(a,e){if("a1"==e)var s=i.tabela_possibilidades.find("tbody tr td:nth-child(1) input"),o=i.tabela_possibilidades.find("tbody tr");else{if("a2"!=e)return;s=i.tabela_possibilidades_a2.find("tbody tr td:nth-child(1) input"),o=i.tabela_possibilidades_a2.find("tbody tr")}s.keydown(function(a){if(13===a.which){var i=s.index(this)+1;s.eq(i).focus()}});var t=a.length;s.val(""),$.each(o,function(i,e){i+1<=t&&($(e).find("td input").attr("data-id",a[i].id),$(e).find("td input").val(a[i].descricao))})},this.atualiza_possibilidades=function(a,e){WS.get("competencias_essenciais_acao/listar/",{habilidade_id:a,competencias_essenciais:i.competencias_essenciais_id},function(a){i.preencher_possibilidades(a,e)})},this.salva_possibilidade_acao_24_horas=function(a,e,s){WS.post("competencias_essenciais_acao/salvar/",{possibilidades:JSON.stringify(a),id_responsabilidade_escolhida:e,usuario_id:i.usuario_id},function(a){var e=a[0];i.preencher_acao_possibilidades(s,e[0].habilidade_id),alert_saved("Salvo com sucesso"),void 0!==i.onsave&&i.onsave&&i.onsave(a)})},this.preencher_possibilidades_acao_24_horas=function(a,e){if(i.arr_possibilidades_acao_24_horas=[],"a1"==e)var s=i.tabela_possibilidades_acao.find("tbody tr td:nth-child(1) input"),o=i.tabela_possibilidades_acao.find("tbody tr");else{if("a2"!=e)return;s=i.tabela_possibilidades_acao_a2.find("tbody tr td:nth-child(1) input"),o=i.tabela_possibilidades_acao_a2.find("tbody tr")}var t=a.length;s.val(""),$.each(o,function(e,s){e+1<=t?($(s).attr("data-id",a[e].id),$(s).find("td input").val(a[e].descricao),$(s).find("[type='checkbox']").prop("disabled",!1),"S"==a[e].acao_vinte_quatro_horas&&(0==i.MODO_EDICAO?($(s).find("[type='checkbox']").prop("disabled",!1),$(s).find("[type='checkbox']").prop("checked",!0).change(),$(s).find("[type='checkbox']").prop("disabled",!0)):$(s).find("[type='checkbox']").prop("checked",!0).change())):$(s).find("[type='checkbox']").prop("disabled",!0)})},this.preencher_acao_possibilidades=function(a,e){WS.get("competencias_essenciais_acao/listar/",{habilidade_id:e,competencias_essenciais_id:i.competencias_essenciais_id},function(e){var s=$.map(e,function(a,i){if("S"==a.acao_vinte_quatro_horas)return a});if("a1"==a)var o=i.tabela_acao_possibilidade.find("tbody tr textarea"),t=i.tabela_acao_possibilidade.find("tbody tr label.lbl_titulo"),d=i.tabela_acao_possibilidade.find("tbody tr");else{if("a2"!=a)return;o=i.tabela_acao_possibilidade_a2.find("tbody tr textarea"),t=i.tabela_acao_possibilidade_a2.find("tbody tr label.lbl_titulo"),d=i.tabela_acao_possibilidade_a2.find("tbody tr")}var n=s.length;o.val(""),$.each(d,function(a,e){if(a+1<=n){var d=$(e).find("td");d.attr("data-id",s[a].id),$(t[a]).text(s[a].descricao),$(o[a]).val(s[a].meta_acao_24_horas),d.removeClass("hidden").attr("data-agenda-gerada",s[a].agenda_gerada).attr("data-status",s[a].status).attr("data-habilidade-id",s[a].habilidade_id).attr("data-avaliacao-id",s[a].competencias_essenciais_avaliacao_id);var c=$(e).find(".btn_info_carta"),l=$(e).find(".btn_definir_metas"),r=$(e).find(".btn_gerar_agenda"),_=d.attr("data-status"),p=$(e).find(".lbl_info"),h=d.attr("data-avaliacao-id");l.unbind("click"),l.click(function(i){View.load("competencias_essenciais/metas_indicador_competencia",function(i,o){o.show(s[a].id,s[a].competencias_essenciais_id,s[a].habilidade_id,h,_,s[a].descricao,s[a].usuario_id);o.onsave=function(a,i){$(e).find("td").attr("data-status",a),p.removeClass("label-warning label-success label-info label-danger"),1==i&&$(e).find("td").attr("data-agenda-gerada","S"),_=a,a==STATUS_INDICADORES.NAO_APROVADO?(c.prop("disabled",!1),c.addClass("btn-danger"),p.text("Não Aprovado"),p.addClass("label-warning")):a==STATUS_INDICADORES.NAO_INICIADO||a==STATUS_INDICADORES.EM_ELABORACAO||a==STATUS_INDICADORES.EM_APROVACAO?c.prop("disabled",!0):a==STATUS_INDICADORES.EM_ANDAMENTO?("S"!=App.sessao.dados.supervisor_empenho&&1!=App.sessao.dados.admin||(1==i?(r.removeClass("hidden"),r.text("Agenda gerada"),r.removeClass("btn-info").addClass("btn-link"),r.prop("disabled",!0)):r.removeClass("hidden")),c.prop("disabled",!1),c.addClass("btn-success"),p.text("Em Andamento"),p.addClass("label-success")):a==STATUS_INDICADORES.REFAZER?(p.text("Aguardando revisão"),p.addClass("label-info")):c.prop("disabled",!1)},o.onclose=function(a){+a>0&&(a==STATUS_INDICADORES.EM_APROVACAO?(p.text("Em Aprovação"),p.addClass("label-info")):a==STATUS_INDICADORES.EM_ANDAMENTO&&"S"==App.sessao.dados.supervisor_empenho&&(p.text("Em Andamento"),p.addClass("label-success")))}})}),_==STATUS_INDICADORES.NAO_INICIADO||_==STATUS_INDICADORES.EM_ELABORACAO||_==STATUS_INDICADORES.EM_APROVACAO?c.prop("disabled",!0):c.prop("disabled",!1),_==STATUS_INDICADORES.EM_APROVACAO&&(p.text("Em Aprovação"),p.addClass("label-info")),_==STATUS_INDICADORES.NAO_APROVADO?(c.addClass("btn-danger"),p.text("Não Aprovado"),p.addClass("label-danger")):_==STATUS_INDICADORES.EM_ANDAMENTO?(c.addClass("btn-success"),p.text("Em Andamento"),p.addClass("label-success")):_==STATUS_INDICADORES.REFAZER&&(p.text("Aguardando revisão"),p.addClass("label-info")),c.unbind("click"),c.click(function(e){$(e.target);+h>0&&View.load("competencias_essenciais/avaliar",function(e,o){o.show(i.competencias_essenciais_id,s[a].habilidade_id,s[a].competencias_essenciais_avaliacao_id,s[a].id,FORMULARIO.VISUALIZAR)})}),"S"!=App.sessao.dados.supervisor_empenho&&1!=App.sessao.dados.admin||(_==STATUS_INDICADORES.EM_ANDAMENTO&&r.removeClass("hidden"),"S"!=d.attr("data-agenda-gerada")?(r.unbind("click"),r.click(function(e){var o,t=$(e.target);if($(t).closest("td").attr("data-status")!=STATUS_INDICADORES.EM_ANDAMENTO&&"S"!=App.sessao.dados.supervisor_empenho)return(o=new Validation).add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Metas ainda não foram aprovadas!")),void alert_modal("Validação",o);(o=new Validation).add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Tem certeza que deseja gerar a agenda?")),alert_modal("Competências Essenciais",o,"Sim",function(){WS.post("competencias_essenciais_resultado_esperado/gerar_agenda/",{competencias_essenciais_acao_id:s[a].id},function(a){$(t).closest("td").attr("data-agenda-gerada","S");var e=new Validation;e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Agenda gerada com sucesso!")),r.text("Agenda gerada"),r.removeClass("btn-info").addClass("btn-link"),r.prop("disabled",!0),alert_modal("Validação",e),alert_saved("Salvo com sucesso"),void 0!==i.onsave&&i.onsave&&i.onsave(a)})},!0,"Não",null,function(){})})):(r.text("Agenda gerada"),r.removeClass("btn-info").addClass("btn-link"),r.prop("disabled",!0)))}else $(e).find("td").addClass("hidden")})})},this.atualiza_possibilidades_acao_24_horas=function(a,e){WS.get("competencias_essenciais_acao/listar/",{habilidade_id:a,competencias_essenciais_id:i.competencias_essenciais_id},function(a){i.preencher_possibilidades_acao_24_horas(a,e)})},this.salva_dados_habilidades=function(a){WS.post("competencias_essenciais_habilidades/salvar/",{habilidades:JSON.stringify(a),competencias_essenciais_id:i.competencias_essenciais_id,calculo_efetividade:parseInt(i.media_efetividade.text()),calculo_desejado:parseInt(i.media_desejado.text()),calculo_qe:parseInt(i.media_qe.text()),usuario_id:i.usuario_id},function(a){i.preencher_habilidades(i.competencias_essenciais_id),i.carrega_habilidades_a(),alert_saved("Salvo com sucesso"),void 0!==i.onsave&&i.onsave&&i.onsave(a)})},this.preencher_habilidades=function(a){WS.get("competencias_essenciais_habilidades/listar/",{competencias_essenciais_id:a},function(a){var e=a;i.arr_habilidades=[],$.each(i.tabela_habilidades.find("tbody tr"),function(a,s){$(s).find("td input").val(""),$(s).find("td:nth-child(2) select").keyup(i.calculo_qe).keyup(i.calcula_media),$(s).find("td:nth-child(3) input").keyup(i.calculo_qe).keyup(i.calcula_media),$(s).find("td:nth-child(4) input").keyup(i.calculo_qe).keyup(i.calcula_media),$.each(e,function(o,t){a==o&&($(s).attr("data-id",e[o].id),$(s).find("td:nth-child(1) input").val(e[o].descricao),$(s).find("td:nth-child(2) select").val(e[o].curva_abc).change(i.calculo_qe).change(i.calcula_media).trigger("change"),$(s).find("td:nth-child(3) input").val(e[o].efetividade).change(i.calculo_qe).change(i.calcula_media).trigger("change"),$(s).find("td:nth-child(4) input").val(e[o].desejado).change(i.calculo_qe).change(i.calcula_media).trigger("change"))})})})},this.calcula_media=function(a){for(var e=$(a.target).closest("table"),s=e.find("td:nth-child(3) input"),o=e.find("td:nth-child(4) input"),t=e.find("td:nth-child(5) div"),d=e.find("td:nth-child(2) select"),n=0,c=0,l=0,r=0,_=0,p=0,h=0,u=0;u<$(o).length;u++)"A"==$(d[u]).val().toUpperCase()?(n+=PESOS_HPE.A,c=parseInt($(s[u]).val())*PESOS_HPE.A,l=parseInt($(o[u]).val())*PESOS_HPE.A,_=parseInt($(t[u]).text())*PESOS_HPE.A):"B"==$(d[u]).val().toUpperCase()?(n+=PESOS_HPE.B,c=parseInt($(s[u]).val())*PESOS_HPE.B,l=parseInt($(o[u]).val())*PESOS_HPE.B,_=parseInt($(t[u]).text())*PESOS_HPE.B):"C"==$(d[u]).val().toUpperCase()&&(n+=PESOS_HPE.C,c=parseInt($(s[u]).val())*PESOS_HPE.C,l=parseInt($(o[u]).val())*PESOS_HPE.C,_=parseInt($(t[u]).text())*PESOS_HPE.C),""!=$(o[u]).val()&&(r+=l),""!=$(s[u]).val()&&(p+=c),""!=$(t[u]).text()&&(h+=_);(p>0||n>0||r>0||h>0)&&(i.media_efetividade.text(Math.ceil(p/n)),i.media_desejado.text(Math.ceil(r/n)),i.media_qe.text(Math.ceil(h/n)))},this.calculo_qe=function(a){var i=$(this).closest("tr"),e=i.find(":nth-child(3) input").val(),s=i.find(":nth-child(4) input").val();if(""!=e&&""!=s&&parseInt(e)<parseInt(s)){var o=100*(s-e)/e;i.find(":nth-child(5) div").text(Math.ceil(o)).attr("readonly",!0).attr("rel","tooltip").css("cursor","pointer").tooltip({title:"Deve existir um aumento de "+Math.ceil(o)+"% em relação à efetividade atual para atingir o desejado.",placement:"left"}).attr("data-toggle","tooltip").attr("data-html","true"),i.find(":nth-child(5) div").parent().css("vertical-align","middle").css("text-align","center")}else i.find(":nth-child(5) div").text(0).css("vertical-align","middle").css("text-align","center")},this.carrega_habilidades_a=function(){WS.get("competencias_essenciais_habilidades/listar/",{competencias_essenciais_id:i.competencias_essenciais_id,tipo:"a"},function(a){var e=a[0],s=a[1];void 0!==e&&""!=e.descricao?i.descricao_habilidade_escolhida.text(e.descricao):i.descricao_habilidade_escolhida.text("");var o=void 0===e||0==e.id&&""==e.id?0:e.id,t=void 0===e||0==s.id&&""==s.id?0:s.id;i.id_habilidade_escolhida=o,i.atualiza_possibilidades(o,"a1"),i.descricao_habilidade_escolhida_a2.text(void 0!==e&&s.descricao),i.id_habilidade_escolhida_a2=t,i.atualiza_possibilidades(t,"a2"),i.atualiza_possibilidades_acao_24_horas(i.id_habilidade_escolhida,"a1"),i.atualiza_possibilidades_acao_24_horas(i.id_habilidade_escolhida_a2,"a2"),i.preencher_acao_possibilidades("a1",o),i.preencher_acao_possibilidades("a2",t)})},this.arr_metodos_telas=[{metodo:function(){}},{metodo:function(){i.arr_habilidades=[],$.each(i.tabela_habilidades.find("tbody tr"),function(a,e){var s=$(e).find("td:nth-child(1) input");$(e).find("td:nth-child(2) select").addClass("input_abc"),""!=s.val().trim()&&i.arr_habilidades.push({habilidade:$(e).find("td:nth-child(1) input").val(),curva_abc:$(e).find("td:nth-child(2) select").val(),efetividade:$(e).find("td:nth-child(3) input").val(),desejado:$(e).find("td:nth-child(4) input").val(),quociente_efetividade:$(e).find("td:nth-child(5) div").text(),id:$(e).attr("data-id")})});var a=0;if($.each(i.arr_habilidades,function(i,e){"A"==e.curva_abc.toUpperCase()&&a++}),$.each(i.tabela_habilidades.find("tbody tr"),function(a,e){if(""!=$(e).find("td:nth-child(1) input").val()&&""!=$(e).find("td:nth-child(2) select").val()&&""==$(e).find("td:nth-child(3) input").val()){var s=new Validation;return s.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Preencha a Efetividade.")),alert_modal("Competências Essenciais",s,null,function(){$(e).find("td:nth-child(3) input").focus()}),i.flag_salvar=!1,i.indice_atual>0&&i.indice_atual--,i.passos(i.indice_atual),!1}}),2!=a){var e=new Validation;e.add(new ValidationMessage(Validation.CODES.ERR_FIELD,'Escolha pelo menos duas curvas do tipo "A"')),alert_modal("Validação",e),i.indice_atual--,i.passos(i.indice_atual)}else 1==i.flag_salvar&&1==i.MODO_EDICAO?i.salva_dados_habilidades(i.arr_habilidades):i.carrega_habilidades_a();i.voltar_ao_topo()}},{metodo:function(){var a=i.tabela_possibilidades.find("tbody tr td:nth-child(1) input");i.arr_possibilidades=[],$.each(a,function(a,e){""!=$(e).val()&&i.arr_possibilidades.push({descricao:$(e).val(),id:$(e).attr("data-id")})}),1==i.flag_salvar&&1==i.MODO_EDICAO?i.salva_possibilidade_acao(i.arr_possibilidades,i.id_habilidade_escolhida,"a1"):i.atualiza_possibilidades_acao_24_horas(i.id_habilidade_escolhida,"a1"),i.voltar_ao_topo()}},{metodo:function(){var a=i.tabela_possibilidades_acao.find("tbody tr").find(".check_acao input"),e=0;if($.each(a,function(a,i){1==$(i).prop("checked")&&(e+=1)}),e<=0){var s=new Validation;s.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Escolha ao menos uma ação de 24 horas")),alert_modal("Validação",s),i.flag_salvar=!1,i.indice_atual--,i.passos(i.indice_atual)}var o=i.tabela_possibilidades.find("tbody tr td:nth-child(1) input");i.arr_acoes_possibilidades=[],$.each(o,function(a,e){""!=$(e).val()&&i.arr_acoes_possibilidades.push({id:$(e).attr("data-id")})}),i.voltar_ao_topo()}},{metodo:function(){var a=i.tabela_acao_possibilidade.find("tbody tr");$.each(a,function(a,e){$.each(i.arr_acoes_possibilidades,function(a,s){s.id==$(e).find("td").attr("data-id")&&""!=$(e).find("td textarea").val()&&(i.arr_acoes_possibilidades[a].meta_acao_24_horas=$(e).find("td textarea").val())})}),1==i.flag_salvar&&1==i.MODO_EDICAO&&i.salva_possibilidade_acao(i.arr_acoes_possibilidades,i.id_habilidade_escolhida,"a1"),i.voltar_ao_topo()}},{metodo:function(){var a=i.tabela_possibilidades_a2.find("tbody tr td:nth-child(1) input");i.arr_possibilidades_a2=[],$.each(a,function(a,e){""!=$(e).val()&&i.arr_possibilidades_a2.push({descricao:$(e).val(),id:$(e).attr("data-id")})}),1==i.flag_salvar&&1==i.MODO_EDICAO?i.salva_possibilidade_acao(i.arr_possibilidades_a2,i.id_habilidade_escolhida_a2,"a2"):i.atualiza_possibilidades_acao_24_horas(i.id_habilidade_escolhida_a2,"a2"),i.voltar_ao_topo()}},{metodo:function(){var a=i.tabela_possibilidades_a2.find("tbody tr td:nth-child(1) input");i.arr_possibilidades_a2=[],$.each(a,function(a,e){""!=$(e).val()&&i.arr_possibilidades_a2.push({descricao:$(e).val(),id:$(e).attr("data-id")})}),1==i.flag_salvar&&1==i.MODO_EDICAO?i.salva_possibilidade_acao(i.arr_possibilidades_a2,i.id_habilidade_escolhida_a2,"a2"):i.atualiza_possibilidades_acao_24_horas(i.id_habilidade_escolhida_a2,"a2");a=i.tabela_possibilidades_a2.find("tbody tr td:nth-child(1) input");i.arr_acoes_possibilidades_a2=[],$.each(a,function(a,e){""!=$(e).val()&&i.arr_acoes_possibilidades_a2.push({id:$(e).attr("data-id")})})}},{metodo:function(){var a=i.tabela_possibilidades_acao_a2.find("tbody tr").find(".check_acao_a2 input"),e=0;if($.each(a,function(a,i){1==$(i).prop("checked")&&(e+=1)}),e<=0){var s=new Validation;s.add(new ValidationMessage(Validation.CODES.ERR_FIELD,"Escolha ao menos uma ação de 24 horas")),alert_modal("Validação",s),i.flag_salvar=!1,i.indice_atual--,i.passos(i.indice_atual)}}}],this.passos=function(a){i.dialog.find("[tipo='etapa']").addClass("hidden"),$(i.arr_steps).removeClass("active"),i.arr_telas.length==a+1?(i.btn_confirmar.css("display","inline-block"),i.btn_proxima_etapa.addClass("hidden")):(i.btn_confirmar.css("display","none"),i.btn_proxima_etapa.removeClass("hidden")),$(i.arr_telas[a]).removeClass("hidden"),$(i.arr_steps[a]).addClass("active"),0!=a?i.btn_voltar.removeClass("hidden"):i.btn_voltar.addClass("hidden"),i.arr_metodos_telas[a].metodo(),i.pagina.text(a+1+"/"+i.arr_metodos_telas.length)},this.pega_telas=function(){$.each(i.dialog.find("[tipo='etapa']"),function(a,e){i.arr_telas.push(e)}),$.each(i.steps.find("li"),function(a,e){$(e).click(function(e){i.passos(a),i.indice_atual=a}),i.arr_steps.push(e)})},i.pega_telas(),i.passos(i.indice_atual),i.steps.find("li").hide(),this.unload=function(){i.close(),View.unload(this.html_id)},this.close=function(){void 0!==i.onclose&&i.onclose&&i.onclose()}}});