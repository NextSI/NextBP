define([],function(){return function(o){"use strict";var a=this;this.html_id=o,this.dialog=$("#"+this.html_id),this.modal=this.dialog.find(".modal"),this.modal.attr("id",this.html_id+"_modal"),this.title=this.modal.find(".modal-title"),this.tipo=null,this.onclose=null,this.ondelete=null,this.btn_cancelar=this.dialog.find(".btn_cancelar"),this.btn_download=this.dialog.find(".btn_download"),this.pdf_viewer=this.dialog.find(".pdf_viewer"),this.arquivo=null,this.documento_revisao_id=null,this.documento_id=null,this.token=null,this.revisao_ativa=null,this.revisao_aprovada=null,this.documento_bloqueado=null,this.controle_distribuicao=null,this.show=function(o,i,t,n,e,d,l,s,r){void 0===l&&(l=!0),void 0===s&&(s=!0),a.arquivo=i,a.documento_id=t,a.documento_revisao_id=o,a.token=cripto(WS.token),a.revisao_ativa=n,a.revisao_aprovada=e,a.documento_bloqueado=d,a.controle_distribuicao=l,a.documento_revisao_id>0?a.arquivo=WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id+"&token_publico="+a.token+"&tipo=S&login_anonimo="+(!0===WS.login_anonimo?"true":"false"):a.btn_download.addClass("hidden"),show_modal(a.modal.attr("id"));var c={supportRedirect:!0};detectmob()&&(c.fallbackLink=s?"<p>Download do PDF <a href='"+a.arquivo+"&acao=abrir'></a></p>":"<p>Você não possui permissão para baixar este documento.</p>");let u="&acao=abrir";s||(u+="#toolbar=0",a.btn_download.addClass("hidden"),a.modal.bind("contextmenu",function(o){return alert_warning("Você não possui permissão para realizar esta ação."),!1})),PDFObject.supportsPDFs?PDFObject.embed(r||a.arquivo+u,a.pdf_viewer,c):a.pdf_viewer.html("Este navegador não suporta visualização de PDF."),rescale(a.html_id)},this.close=function(){close_modal(a.modal.attr("id")),void 0!==a.onclose&&a.onclose&&a.onclose()},this.unload=function(){a.close(),View.unload(this.html_id)},this.btn_cancelar.unbind("click"),this.btn_cancelar.click(function(){a.unload()}),this.btn_download.unbind("click"),this.btn_download.click(function(){var o=function(){App.sessao?App.obter_token_publico(function(o){App.download(WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id+"&token_publico="+o),"safari"!=getBrowser()&&a.unload()}):(App.download(WS_URI+"documento/download/?documento_revisao_id="+a.documento_revisao_id+"&documento_id="+a.documento_id),"safari"!=getBrowser()&&a.unload())};void 0===a.revisao_ativa||void 0===a.revisao_aprovada||void 0===a.documento_bloqueado||"S"==a.revisao_ativa&&"S"==a.revisao_aprovada&&"S"!=a.documento_bloqueado?o():"N"==a.revisao_aprovada?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>reprovada,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):null==a.revisao_aprovada||"N"==a.controle_distribuicao?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-info" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>pendente,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):"N"==a.revisao_ativa?alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-warning" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar uma revisão </strong>obsoleta,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0):"S"==a.documento_bloqueado&&alert_modal('<i class="fa fa-exclamation-triangle pull-left" aria-hidden="true"></i> Atenção !','<div class="alert alert-danger" style="text-align: center"> <span href="#" class="alert-link"><strong>Você está tentando baixar um documento </strong>bloqueado,<strong> deseja continuar ?  </strong></span></div>','<i class="fa fa-download" aria-hidden="true"></i> Download',function(){o()},!0)})}});